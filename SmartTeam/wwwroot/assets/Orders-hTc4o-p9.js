import{r as c,bm as A,e as D,bn as F,bo as $,j as e,_ as j,al as H,M as R,N as B,y as N}from"./index-DXStjdCc.js";import{F as U}from"./file-text-BhHmwouq.js";import{f as w}from"./format-CSQe5d3I.js";import{E as _}from"./eye-Ca6khng2.js";import{C as Q}from"./circle-x-ClPd2jqL.js";import{T as G}from"./truck-CFWlfweT.js";import{C as I}from"./circle-check-big-B0Ulk6iR.js";import{C as X}from"./clock-41GFeLxa.js";const ae=()=>{const[r,u]=c.useState(1),[g,Z]=c.useState(10),[x,v]=c.useState(""),[l,C]=c.useState(""),[S,{isFetching:m}]=A(),b=D();c.useEffect(()=>{const s=setTimeout(()=>{C(x),u(1)},500);return()=>clearTimeout(s)},[x]);const d=l.trim().length>0,{data:k,isLoading:E,isError:q}=F({page:r,pageSize:g},{skip:d}),{data:P,isLoading:z,isError:J}=$({customerName:l,page:r,pageSize:g},{skip:!d}),n=d?P:k,L=d?z:E,o=n?.items||[],h=n?.totalCount||0,i=n?.totalPages||0,y=n?.hasNextPage||!1,f=n?.hasPreviousPage||!1,T=s=>{switch(s){case 0:return"bg-yellow-100 text-yellow-700 border-yellow-200";case 1:return"bg-blue-100 text-blue-700 border-blue-200";case 2:return"bg-green-100 text-green-700 border-green-200";case 3:return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},M=s=>{switch(s){case 0:return e.jsx(X,{size:16});case 1:return e.jsx(I,{size:16});case 2:return e.jsx(G,{size:16});case 3:return e.jsx(Q,{size:16});default:return null}},p=s=>{s>=1&&s<=i&&u(s)},O=async()=>{try{const s=await S({}).unwrap(),a=window.URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.setAttribute("download",`Orders_Export_${w(new Date,"dd-MM-yyyy")}.pdf`),document.body.appendChild(t),t.click(),t.remove(),window.URL.revokeObjectURL(a),N.success("Hesabat endirilir...")}catch(s){N.error("PDF export xətası"),console.error("Bulk PDF Export Error:",s)}};return L?e.jsx("div",{className:"flex items-center justify-center min-h-[400px] bg-[#111111]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):e.jsxs("div",{className:"p-6 min-h-screen text-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold !text-white",children:"Sifarişlər"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Sistemdəki bütün sifarişlərin idarə edilməsi"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:O,disabled:m,className:`bg-[#1a1a1a] p-3 px-6 rounded-2xl shadow-sm border border-gray-800 flex items-center gap-3 hover:bg-white/5 transition-all text-white font-semibold ${m?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(U,{size:20,className:"text-red-500"}),m?"Hazırlanır...":"Eksport (PDF)"]}),e.jsxs("div",{className:"bg-[#1a1a1a] p-3 rounded-2xl shadow-sm border border-gray-800 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/10 rounded-xl flex items-center justify-center",children:e.jsx(j,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Ümumi sifariş"}),e.jsx("p",{className:"text-lg font-bold text-white",children:h})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(H,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Müştəri adı ilə axtar...",value:x,onChange:s=>v(s.target.value),className:"w-full bg-[#1a1a1a] border border-gray-800 rounded-2xl pl-12 pr-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-green-500 transition-colors"})]}),l&&e.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:['"',l,'" üçün ',h," nəticə tapıldı"]})]}),e.jsxs("div",{className:"bg-[#1a1a1a] rounded-3xl shadow-sm border border-gray-800 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#151515] border-b border-gray-800 font-semibold text-gray-400 uppercase text-xs tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Sifariş №"}),e.jsx("th",{className:"px-6 py-4",children:"Müştəri"}),e.jsx("th",{className:"px-6 py-4",children:"Aptek"}),e.jsx("th",{className:"px-6 py-4",children:"Məhsul sayı"}),e.jsx("th",{className:"px-6 py-4",children:"Məbləğ"}),e.jsx("th",{className:"px-6 py-4",children:"Status"}),e.jsx("th",{className:"px-6 py-4",children:"Tarix"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Fəaliyyət"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800 text-sm",children:o?.map(s=>e.jsxs("tr",{onClick:()=>b(`/admin/orders/${s.id}`),className:"hover:bg-[#202020] transition-colors cursor-pointer group",children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-white",children:["#",s.orderNumber]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"font-semibold text-white",children:s.customerName})}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-300",children:s.pharmacyName||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"bg-[#252525] text-gray-300 px-2 py-1 rounded-lg text-xs font-medium",children:[s.itemsCount," məhsul"]})}),e.jsxs("td",{className:"px-6 py-4 font-bold text-white",children:[s.totalAmount?.toFixed(2)," AZN"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full border text-xs font-semibold ${T(s.status)}`,children:[M(s.status),s.statusText]})}),e.jsx("td",{className:"px-6 py-4 text-gray-400",children:s.createdAt?w(new Date(s.createdAt),"dd.MM.yyyy HH:mm"):"-"}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("button",{onClick:a=>{a.stopPropagation(),b(`/admin/orders/${s.id}`)},className:"inline-flex items-center gap-1 text-white hover:bg-white/10 px-4 py-2 rounded-xl transition-all font-semibold group-hover:bg-white/5 shadow-sm",children:["Bax ",e.jsx(_,{size:16,className:"group-hover:scale-110 transition-transform"})]})})]},s.id))})]})}),(!o||o.length===0)&&e.jsxs("div",{className:"py-20 text-center",children:[e.jsx(j,{className:"mx-auto text-gray-700 mb-4",size:48}),e.jsx("p",{className:"text-gray-500 font-medium",children:l?"Heç bir sifariş tapılmadı":"Hələ sifariş yoxdur"})]}),o&&o.length>0&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-800 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Səhifə ",r," / ",i," (Ümumi: ",h," sifariş)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>p(r-1),disabled:!f,className:`p-2 rounded-xl transition-colors ${f?"bg-white/10 text-white hover:bg-white/20":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:e.jsx(R,{size:20})}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(Math.min(5,i))].map((s,a)=>{let t;return i<=5||r<=3?t=a+1:r>=i-2?t=i-4+a:t=r-2+a,e.jsx("button",{onClick:()=>p(t),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${r===t?"bg-green-500 text-white":"bg-white/10 text-gray-300 hover:bg-white/20"}`,children:t},t)})}),e.jsx("button",{onClick:()=>p(r+1),disabled:!y,className:`p-2 rounded-xl transition-colors ${y?"bg-white/10 text-white hover:bg-white/20":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:e.jsx(B,{size:20})})]})]})]})]})};export{ae as default};
