import{l as $e,R as he,r as a,u as Ne,m as Ce,k as Te,n as Le,o as Oe,p as Ae,j as t,t as pe,X as _e,F as De,q as Ie,s as Me,v as Ve,A as Re,w as Be,x as Ye,z as ze,B as He,C as Ue,D as Qe,E as Ge,i as We,b as qe,y as Ze,U as Xe}from"./index-DXStjdCc.js";import{B as Je}from"./Breadcrumb-B_lvhuDM.js";import{C as Pe}from"./chevron-down-B4kPK6ik.js";import{C as Ke}from"./chevron-up-DGkpZrnm.js";import{P as et}from"./ProductCard-DXtu-azB.js";import{C as tt}from"./CartUtils-BCvxUx-5.js";import{S as st}from"./SEO-C2ERl3sz.js";import"./heart-jU-8cjoc.js";import"./check-Dpn_xF6k.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],nt=$e("sliders-horizontal",at);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Se=function(r,o){return Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,e){s.__proto__=e}||function(s,e){for(var d in e)e.hasOwnProperty(d)&&(s[d]=e[d])},Se(r,o)};function rt(r,o){Se(r,o);function s(){this.constructor=r}r.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}var ye=function(){return ye=Object.assign||function(o){for(var s,e=1,d=arguments.length;e<d;e++){s=arguments[e];for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(o[f]=s[f])}return o},ye.apply(this,arguments)};function it(r,o,s,e){var d,f=!1,p=0;function L(){d&&clearTimeout(d)}function S(){L(),f=!0}typeof o!="boolean"&&(e=s,s=o,o=void 0);function x(){var E=this,O=Date.now()-p,D=arguments;if(f)return;function k(){p=Date.now(),s.apply(E,D)}function F(){d=void 0}e&&!d&&k(),L(),e===void 0&&O>r?k():o!==!0&&(d=setTimeout(e?F:k,e===void 0?r-O:r))}return x.cancel=S,x}var fe={Pixel:"Pixel",Percent:"Percent"},Fe={unit:fe.Percent,value:.8};function Ee(r){return typeof r=="number"?{unit:fe.Percent,value:r*100}:typeof r=="string"?r.match(/^(\d*(\.\d+)?)px$/)?{unit:fe.Pixel,value:parseFloat(r)}:r.match(/^(\d*(\.\d+)?)%$/)?{unit:fe.Percent,value:parseFloat(r)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),Fe):(console.warn("scrollThreshold should be string or number"),Fe)}var lt=(function(r){rt(o,r);function o(s){var e=r.call(this,s)||this;return e.lastScrollTop=0,e.actionTriggered=!1,e.startY=0,e.currentY=0,e.dragging=!1,e.maxPullDownDistance=0,e.getScrollableTarget=function(){return e.props.scrollableTarget instanceof HTMLElement?e.props.scrollableTarget:typeof e.props.scrollableTarget=="string"?document.getElementById(e.props.scrollableTarget):(e.props.scrollableTarget===null&&console.warn(`You are trying to pass scrollableTarget but it is null. This might
        happen because the element may not have been added to DOM yet.
        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.
      `),null)},e.onStart=function(d){e.lastScrollTop||(e.dragging=!0,d instanceof MouseEvent?e.startY=d.pageY:d instanceof TouchEvent&&(e.startY=d.touches[0].pageY),e.currentY=e.startY,e._infScroll&&(e._infScroll.style.willChange="transform",e._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},e.onMove=function(d){e.dragging&&(d instanceof MouseEvent?e.currentY=d.pageY:d instanceof TouchEvent&&(e.currentY=d.touches[0].pageY),!(e.currentY<e.startY)&&(e.currentY-e.startY>=Number(e.props.pullDownToRefreshThreshold)&&e.setState({pullToRefreshThresholdBreached:!0}),!(e.currentY-e.startY>e.maxPullDownDistance*1.5)&&e._infScroll&&(e._infScroll.style.overflow="visible",e._infScroll.style.transform="translate3d(0px, "+(e.currentY-e.startY)+"px, 0px)")))},e.onEnd=function(){e.startY=0,e.currentY=0,e.dragging=!1,e.state.pullToRefreshThresholdBreached&&(e.props.refreshFunction&&e.props.refreshFunction(),e.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame(function(){e._infScroll&&(e._infScroll.style.overflow="auto",e._infScroll.style.transform="none",e._infScroll.style.willChange="unset")})},e.onScrollListener=function(d){typeof e.props.onScroll=="function"&&setTimeout(function(){return e.props.onScroll&&e.props.onScroll(d)},0);var f=e.props.height||e._scrollableNode?d.target:document.documentElement.scrollTop?document.documentElement:document.body;if(!e.actionTriggered){var p=e.props.inverse?e.isElementAtTop(f,e.props.scrollThreshold):e.isElementAtBottom(f,e.props.scrollThreshold);p&&e.props.hasMore&&(e.actionTriggered=!0,e.setState({showLoader:!0}),e.props.next&&e.props.next()),e.lastScrollTop=f.scrollTop}},e.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:s.dataLength},e.throttledOnScrollListener=it(150,e.onScrollListener).bind(e),e.onStart=e.onStart.bind(e),e.onMove=e.onMove.bind(e),e.onEnd=e.onEnd.bind(e),e}return o.prototype.componentDidMount=function(){if(typeof this.props.dataLength>"u")throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),typeof this.props.initialScrollY=="number"&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),typeof this.props.refreshFunction!="function"))throw new Error(`Mandatory prop "refreshFunction" missing.
          Pull Down To Refresh functionality will not work
          as expected. Check README.md for usage'`)},o.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},o.prototype.componentDidUpdate=function(s){this.props.dataLength!==s.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},o.getDerivedStateFromProps=function(s,e){var d=s.dataLength!==e.prevDataLength;return d?ye(ye({},e),{prevDataLength:s.dataLength}):null},o.prototype.isElementAtTop=function(s,e){e===void 0&&(e=.8);var d=s===document.body||s===document.documentElement?window.screen.availHeight:s.clientHeight,f=Ee(e);return f.unit===fe.Pixel?s.scrollTop<=f.value+d-s.scrollHeight+1:s.scrollTop<=f.value/100+d-s.scrollHeight+1},o.prototype.isElementAtBottom=function(s,e){e===void 0&&(e=.8);var d=s===document.body||s===document.documentElement?window.screen.availHeight:s.clientHeight,f=Ee(e);return f.unit===fe.Pixel?s.scrollTop+d>=s.scrollHeight-f.value:s.scrollTop+d>=f.value/100*s.scrollHeight},o.prototype.render=function(){var s=this,e=ye({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),d=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),f=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return he.createElement("div",{style:f,className:"infinite-scroll-component__outerdiv"},he.createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(p){return s._infScroll=p},style:e},this.props.pullDownToRefresh&&he.createElement("div",{style:{position:"relative"},ref:function(p){return s._pullDown=p}},he.createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!d&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},o})(a.Component);const ot=({currentSort:r,onSortChange:o,t:s})=>{const[e,d]=a.useState(!1),f=a.useRef(null),p=[{value:"",label:s("sortBy")},{value:"price_asc",label:s("priceLowToHigh")},{value:"price_desc",label:s("priceHighToLow")},{value:"name_asc",label:s("nameAToZ")},{value:"name_desc",label:s("nameZToA")}],L=p.find(x=>x.value===(r||""))||p[0];a.useEffect(()=>{const x=E=>{f.current&&!f.current.contains(E.target)&&d(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const S=x=>{o({target:{value:x}}),d(!1)};return t.jsxs("div",{className:"relative",ref:f,style:{fontFamily:"Montserrat, sans-serif"},children:[t.jsxs("button",{type:"button",onClick:()=>d(!e),className:`w-full px-4 py-2.5 bg-white border rounded-lg text-sm flex items-center justify-between transition-all duration-300 ${e?"border-[#197853] ring-2 ring-[#197853] ring-opacity-20":"border-gray-300 hover:border-[#197853]"}`,children:[t.jsx("span",{className:"text-gray-700",children:L.label}),t.jsx(Pe,{className:`w-4 h-4 text-[#197853] transition-transform duration-300 ${e?"transform rotate-180":""}`})]}),t.jsx("div",{className:`absolute z-20 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden transition-all duration-300 origin-top transform ${e?"opacity-100 scale-y-100 translate-y-0":"opacity-0 scale-y-95 -translate-y-2 pointer-events-none"}`,children:p.map(x=>t.jsx("div",{onClick:()=>S(x.value),className:`px-4 py-2.5 text-sm cursor-pointer transition-colors duration-200 ${r===x.value||!r&&x.value===""?"bg-[#E8F5E9] text-[#197853] font-medium":"text-gray-700 hover:bg-gray-50 hover:text-[#197853]"}`,children:x.label},x.value))})]})},we=({label:r,children:o,isActive:s})=>{const[e,d]=a.useState(!1),f=a.useRef(null);return a.useEffect(()=>{const p=L=>{f.current&&!f.current.contains(L.target)&&d(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]),t.jsxs("div",{className:"relative",ref:f,style:{fontFamily:"Montserrat, sans-serif"},children:[t.jsxs("button",{type:"button",onClick:()=>d(!e),className:`px-4 py-2 bg-white border rounded-lg text-sm flex items-center gap-2 transition-all duration-300 ${e||s?"border-[#197853] ring-1 ring-[#197853] text-[#197853]":"border-gray-200 hover:border-[#197853] text-gray-700"}`,children:[t.jsx("span",{className:"font-medium",children:r}),t.jsx(Pe,{className:`w-4 h-4 text-[#197853] transition-transform duration-300 ${e?"transform rotate-180":""}`})]}),t.jsx("div",{className:`absolute z-30 mt-2 min-w-[240px] bg-white border border-gray-100 rounded-xl shadow-xl p-4 transition-all duration-300 origin-top-left ${e?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-2 pointer-events-none"}`,children:o})]})},ct=he.memo(({onFilterResults:r,onLoadingChange:o,currentSort:s,currentPage:e,isHotDeals:d,isRecommended:f,isBrand:p,isSearch:L,setCurrentPage:S,pageSize:x,forcedCategoryId:E=null,showCategory:O=!1,onSortChange:D})=>{const{t:k,i18n:F}=Ne(),[K,T]=a.useState(!1),[j,A]=a.useState([]),[g,M]=a.useState(""),[v,R]=a.useState(""),[C,B]=a.useState({}),[Q,Y]=a.useState([]),[ve,$]=a.useState([]),[W,z]=a.useState([]),{data:V,isLoading:de}=Ce(),{data:q,isLoading:me}=Te(),{data:_,isLoading:Z}=Le(),[ae,{isLoading:ne}]=Oe(),ee=a.useRef(!1),G=a.useRef(null),se=a.useRef(!0),X=E||(j.length>0?j[0]:null),{data:re,isLoading:ge}=Ae(X,{skip:!X});a.useEffect(()=>{async function l(){const c=F.language;if(c==="en"){if(V){const h=await Promise.all(V.map(async b=>({...b,name:await pe(b.name,c)})));Y(h)}if(q){const h=await Promise.all(q.map(async b=>({...b,name:await pe(b.name,c)})));$(h)}if(_){const h=await Promise.all(_.map(async b=>({...b,name:await pe(b.name,c),options:b.options?await Promise.all(b.options.map(async m=>({...m,displayName:m.displayName?await pe(m.displayName,c):m.displayName,label:m.label?await pe(m.label,c):m.label}))):b.options})));z(h)}}else Y(V||[]),$(q||[]),z(_||[])}l()},[F.language,V,q,_]);const te=X&&re?re:W.length>0?W:_,ie=X?ge:Z,le=a.useCallback(()=>{const l=[];if(O&&j.length>0&&(Q.length>0?Q:V)){const h=Q.length>0?Q:V;j.forEach(b=>{const m=h.find(I=>I.id===b);m&&l.push({id:`category-${b}`,key:`category-${b}`,label:m.name,type:"category",value:b})})}const c=W.length>0?W:_;if(c&&Object.values(C).forEach(h=>{if(h.filterOptionIds&&h.filterOptionIds.length>0){const b=c.find(m=>m.id===h.filterId);b&&h.filterOptionIds.forEach(m=>{const I=b.options?.find(be=>be.id===m);I&&l.push({id:`filter-${h.filterId}-${m}`,key:`filter-${h.filterId}-${m}`,label:`${b.name}: ${I.displayName||I.label}`,type:"custom",filterId:h.filterId,optionId:m})})}}),g||v){const h=g&&v?`Price: $${g} - $${v}`:g?`Price: $${g}+`:`Price: up to $${v}`;l.push({id:"price-range",key:"price-range",label:h,type:"price",minPrice:g,maxPrice:v})}return l},[O,j,V,_,C,g,v]);a.useEffect(()=>{if(te){const l={};te.forEach(c=>{C[c.id]||(l[c.id]={filterId:c.id,filterOptionIds:[],customValue:"",minValue:0,maxValue:0})}),Object.keys(l).length>0&&B(c=>({...c,...l}))}},[te]),a.useEffect(()=>{X&&B({})},[X]),a.useCallback(()=>{T(l=>!l)},[]);const xe=a.useCallback(l=>{S(1),A(c=>c.includes(l)?c.filter(h=>h!==l):[l])},[S]),i=a.useCallback((l,c,h)=>{S(1),B(b=>{const m={...b};return m[c]||(m[c]={filterId:c,filterOptionIds:[],customValue:"",minValue:0,maxValue:0}),l?m[c].filterOptionIds.includes(h)||(m[c].filterOptionIds=[...m[c].filterOptionIds,h]):m[c].filterOptionIds=m[c].filterOptionIds.filter(I=>I!==h),m})},[S]),n=a.useCallback(()=>{const l=[];return Object.values(C).forEach(c=>{(c.filterOptionIds.length>0||c.customValue||c.minValue>0||c.maxValue>0)&&l.push({filterId:c.filterId,filterOptionIds:c.filterOptionIds.length>0?c.filterOptionIds:null,customValue:c.customValue||null,minValue:c.minValue||null,maxValue:c.maxValue||null})}),l},[C]),y=a.useCallback(()=>{const l=O&&j.length>0,c=g||v,h=Object.values(C).some(I=>I.filterOptionIds?.length>0||I.customValue||I.minValue>0||I.maxValue>0);return l||c||h||!!E||s},[O,j,g,v,C,E,s]);a.useEffect(()=>{if(se.current){se.current=!1;return}return G.current&&clearTimeout(G.current),G.current=setTimeout(async()=>{if(!y()){ee.current=!1,r&&r(null,[]);return}ee.current=!0;const c=n(),b={categoryId:E||(j.length>0?j[0]:null)||null,brandSlug:p||null,isHotDeal:d||null,isRecommended:f||null,searchTerm:L||null,filterCriteria:c.length>0?c:[],minPrice:g?parseFloat(g):null,maxPrice:v?parseFloat(v):1e6,sortBy:s?.split("_")[0]||null,sortOrder:s?.split("_")[1]||null,page:1,pageSize:x||20};o&&o(!0);try{const m=await ae(b).unwrap();r&&r(m,le())}catch{r&&r({products:[],totalCount:0},[])}finally{o&&o(!1)}},300),()=>{G.current&&clearTimeout(G.current)}},[j,C,g,v,s,E,d,p,L,x]),a.useEffect(()=>{if(!ee.current||se.current)return;(async()=>{const c=n(),b={categoryId:E||(j.length>0?j[0]:null),brandSlug:p,isHotDeal:d,searchTerm:L,filterCriteria:c.length>0?c:[],minPrice:g?parseFloat(g):null,maxPrice:v?parseFloat(v):null,sortBy:s?.split("_")[0],sortOrder:s?.split("_")[1],page:e,pageSize:x||20};o&&o(!0);try{const m=await ae(b).unwrap();r&&r(m,le())}catch{r&&r({products:[],totalCount:0},[])}finally{o&&o(!1)}})()},[e,x]);const w=a.useCallback(l=>{S(1),M(l.target.value)},[S]),N=a.useCallback(l=>{S(1),R(l.target.value)},[S]);return de?t.jsx("div",{className:"w-full h-12 bg-gray-100 animate-pulse rounded-lg"}):t.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",style:{fontFamily:"Montserrat, sans-serif"},children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-3 flex-1",children:[O&&t.jsx(we,{label:k("filters.category"),isActive:j.length>0,children:t.jsx("div",{className:"max-h-[300px] overflow-y-auto space-y-2 pr-1 custom-scrollbar",children:q?.map(l=>t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50 transition-colors group",children:[t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("input",{type:"checkbox",className:"peer appearance-none w-5 h-5 border border-gray-300 rounded checked:bg-[#197853] checked:border-[#197853] transition-all",checked:j.includes(l.id),onChange:()=>xe(l.id)}),t.jsx("svg",{className:"absolute w-3 h-3 text-white hidden peer-checked:block pointer-events-none left-1",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("polyline",{points:"20 6 9 17 4 12"})})]}),t.jsx("span",{className:`text-sm transition-colors ${j.includes(l.id)?"text-[#197853] font-medium":"text-gray-600 group-hover:text-[#197853]"}`,children:l.name})]},l.id))})}),!ie&&te?.map(l=>{const c=C[l.id]?.filterOptionIds?.length>0;return t.jsx(we,{label:l.name,isActive:c,children:t.jsx("div",{className:"max-h-[300px] overflow-y-auto space-y-2 pr-1 custom-scrollbar",children:l.options?.map(h=>t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-gray-50 transition-colors group",children:[t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("input",{type:"checkbox",className:"peer appearance-none w-5 h-5 border border-gray-300 rounded checked:bg-[#197853] checked:border-[#197853] transition-all",checked:C[l.id]?.filterOptionIds?.includes(h.id)||!1,onChange:b=>i(b.target.checked,l.id,h.id)}),t.jsx("svg",{className:"absolute w-3 h-3 text-white hidden peer-checked:block pointer-events-none left-1",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("polyline",{points:"20 6 9 17 4 12"})})]}),t.jsx("span",{className:`text-sm transition-colors ${C[l.id]?.filterOptionIds?.includes(h.id)?"text-[#197853] font-medium":"text-gray-600 group-hover:text-[#197853]"}`,children:h.displayName||h.label})]},h.id))})},l.id)}),t.jsx(we,{label:k("priceRange"),isActive:g||v,children:t.jsxs("div",{className:"space-y-4 p-1",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:k("productsPage.min")}),t.jsxs("div",{className:"relative",children:[t.jsx("span",{className:"absolute left-3 top-2.5 text-gray-400 text-sm",children:"₼"}),t.jsx("input",{type:"number",placeholder:"0",value:g,onChange:w,className:"w-full pl-7 pr-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-[#197853] focus:ring-1 focus:ring-[#197853] text-sm transition-all",min:"0"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:k("productsPage.max")}),t.jsxs("div",{className:"relative",children:[t.jsx("span",{className:"absolute left-3 top-2.5 text-gray-400 text-sm",children:"₼"}),t.jsx("input",{type:"number",placeholder:"Max",value:v,onChange:N,className:"w-full pl-7 pr-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-[#197853] focus:ring-1 focus:ring-[#197853] text-sm transition-all",min:"0"})]})]})]})}),(ne||ie)&&t.jsx("div",{className:"flex items-center gap-2 text-sm text-[#197853]",children:t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#197853]"})})]}),t.jsx("div",{className:"w-full lg:w-[200px]",children:t.jsx(ot,{currentSort:s,onSortChange:D,t:k})})]})}),je=({title:r,isExpanded:o,onToggle:s,children:e})=>t.jsxs("div",{className:"border-b border-gray-200",children:[t.jsxs("button",{onClick:s,type:"button",className:"w-full px-4 py-4 flex justify-between items-center text-left",children:[t.jsx("span",{className:"text-lg font-medium text-gray-900",children:r}),o?t.jsx(Ke,{size:20}):t.jsx(Pe,{size:20})]}),o&&t.jsx("div",{className:"px-4 pb-4",children:e})]}),ke=({label:r,checked:o,onChange:s})=>t.jsxs("label",{className:"flex items-center py-2 cursor-pointer",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"checkbox",checked:o,onChange:s,className:"sr-only"}),t.jsx("div",{className:`w-5 h-5 border-2 rounded flex items-center justify-center ${o?"bg-[#197853] border-[#197853]":"border-gray-300"}`,children:o&&t.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),t.jsx("span",{className:"ml-3 text-gray-700",children:r})]});function dt({onFilterResults:r,onLoadingChange:o,currentSort:s,onSortChange:e,currentPage:d,pageSize:f}){const{t:p,i18n:L}=Ne(),[S,x]=a.useState(!1),[E,O]=a.useState(!1),[D,k]=a.useState(!1),[F,K]=a.useState([]),[T,j]=a.useState(""),[A,g]=a.useState(""),[M,v]=a.useState({}),[R,C]=a.useState([]),{data:B,isLoading:Q}=Ce(),{data:Y,isLoading:ve}=Te(),{data:$,isLoading:W}=Le(),z=F.length>0?F[0]:null,{data:V,isLoading:de}=Ae(z,{skip:!z}),[q,{isLoading:me}]=Oe(),_=a.useRef(!1);a.useRef(null);const Z=z&&V?V:$,ae=z?de:W,[ne,ee]=a.useState({category:!0,priceRange:!0});a.useEffect(()=>{async function i(){if(!Y||Y.length===0)return;const n=L.language;if(n==="en"){const y=await Promise.all(Y.map(async w=>({...w,name:await pe(w.name,n)})));C(y)}else C(Y)}i()},[L.language,Y]),a.useEffect(()=>(E?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[E]),a.useEffect(()=>{if(Z){const i={};Z.forEach(n=>{M[n.id]||(i[n.id]={filterId:n.id,filterOptionIds:[],customValue:"",minValue:0,maxValue:0})}),v(n=>({...n,...i})),ee(n=>{const y={...n};return Z.forEach(w=>{y[`filter-${w.id}`]===void 0&&(y[`filter-${w.id}`]=!0)}),y})}},[Z]),a.useEffect(()=>{z&&v({})},[z]);const G=i=>{ee(n=>({...n,[i]:!n[i]}))},se=i=>{K(n=>n.includes(i)?n.filter(y=>y!==i):[i])},X=(i,n,y)=>{v(w=>{const N={...w};return N[n]||(N[n]={filterId:n,filterOptionIds:[],customValue:"",minValue:0,maxValue:0}),i?N[n].filterOptionIds.includes(y)||N[n].filterOptionIds.push(y):N[n].filterOptionIds=N[n].filterOptionIds.filter(l=>l!==y),N})},re=()=>{const i=[];return Object.values(M).forEach(n=>{(n.filterOptionIds.length>0||n.customValue||n.minValue>0||n.maxValue>0)&&i.push({filterId:n.filterId,filterOptionIds:n.filterOptionIds.length>0?n.filterOptionIds:null,customValue:n.customValue||null,minValue:n.minValue||null,maxValue:n.maxValue||null})}),i},ge=()=>{const i=[];if(F.length>0&&B&&F.forEach(n=>{const y=B.find(w=>w.id===n);y&&i.push({id:`category-${n}`,key:`category-${n}`,label:y.name,type:"category",value:n})}),$&&Object.values(M).forEach(n=>{if(n.filterOptionIds&&n.filterOptionIds.length>0){const y=$.find(w=>w.id===n.filterId);y&&n.filterOptionIds.forEach(w=>{const N=y.options?.find(l=>l.id===w);N&&i.push({id:`filter-${n.filterId}-${w}`,key:`filter-${n.filterId}-${w}`,label:`${y.name}: ${N.displayName||N.label}`,type:"custom",filterId:n.filterId,optionId:w})})}}),T||A){const n=T&&A?`Price: $${T} - $${A}`:T?`Price: $${T}+`:`Price: up to $${A}`;i.push({id:"price-range",key:"price-range",label:n,type:"price",minPrice:T,maxPrice:A})}return i},te=()=>{const i=F.length>0,n=T||A,y=Object.values(M).some(w=>w.filterOptionIds?.length>0||w.customValue||w.minValue>0||w.maxValue>0);return i||n||y},ie=async()=>{if(!te()){_.current=!1,r&&r(null,[]);return}_.current=!0;let n,y;if(s){const l=s.split("_");l[0]==="price"?(n="price",y=l[1]):l[0]==="name"?(n="name",y=l[1]):s==="newest"&&(n="createdDate",y="desc")}const w=re(),N={categoryId:F.length>0?F[0]:null,filterCriteria:w.length>0?w:[],minPrice:T?parseFloat(T):null,maxPrice:A?parseFloat(A):null,sortBy:n||null,sortOrder:y||null,page:d||1,pageSize:f||20};o&&o(!0);try{const l=await q(N).unwrap(),c=ge();r&&r(l,c)}catch(l){console.error("Failed to filter products:",l),r&&r({products:[],totalCount:0},[])}finally{o&&o(!1)}},le=()=>{K([]),v({}),j(""),g(""),_.current=!1,r&&r(null,[])},xe=()=>{ie(),O(!1)};return a.useEffect(()=>{_.current&&ie()},[d,f]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:`fixed inset-0 bg-white z-5000 flex flex-col ${E?"block":"hidden"}`,children:[t.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[t.jsx("h1",{className:"text-xl font-medium text-gray-900",children:p("filters.filters")}),t.jsx("button",{onClick:()=>O(!1),className:"p-1",children:t.jsx(_e,{size:24,className:"text-gray-600"})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto",children:[t.jsx(je,{title:p("filters.category"),isExpanded:ne.category,onToggle:()=>G("category"),children:t.jsxs("div",{className:"space-y-1",children:[(R.length>0?R:Y)?.slice(0,D?(R.length>0?R:Y).length:5).map(i=>t.jsx(ke,{label:i.name,checked:F.includes(i.id),onChange:()=>se(i.id)},i.id)),(R.length>0?R:Y)?.length>5&&t.jsx("button",{onClick:()=>k(!D),className:"text-sm text-[#197853] hover:text-[#0A4A30] font-medium mt-2",children:p(D?"filters.seeLess":"filters.seeAll")})]})}),ae?t.jsx("div",{className:"p-4",children:t.jsxs("div",{className:"animate-pulse space-y-4",children:[t.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/3"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded w-4/5"})]})]})}):Z?.map(i=>t.jsx(je,{title:i.name,isExpanded:ne[`filter-${i.id}`],onToggle:()=>G(`filter-${i.id}`),children:t.jsx("div",{className:"space-y-1",children:i.options?.map(n=>t.jsx(ke,{label:n.displayName||n.label,checked:M[i.id]?.filterOptionIds?.includes(n.id)||!1,onChange:y=>X(y.target.checked,i.id,n.id)},n.id))})},i.id)),t.jsx(je,{title:p("filters.priceRange"),isExpanded:ne.priceRange,onToggle:()=>G("priceRange"),children:t.jsxs("div",{className:"flex items-center space-x-2",onMouseDown:i=>i.stopPropagation(),onTouchStart:i=>i.stopPropagation(),children:[t.jsx("input",{type:"number",placeholder:p("productsPage.min"),value:T,onChange:i=>j(i.target.value),onFocus:i=>i.stopPropagation(),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#197853] text-sm",min:"0"}),t.jsx("span",{className:"text-gray-500",children:"-"}),t.jsx("input",{type:"number",placeholder:p("productsPage.max"),value:A,onChange:i=>g(i.target.value),onFocus:i=>i.stopPropagation(),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#197853] text-sm",min:"0"})]})})]}),t.jsxs("div",{className:"p-4 border-t border-gray-200 flex gap-3",children:[t.jsx("button",{onClick:le,className:"flex-1 py-3 px-4 border border-gray-300 rounded-lg text-gray-700 font-medium",children:p("productsPage.clear")}),t.jsx("button",{onClick:xe,className:"flex-1 py-3 px-4 bg-[#197853] text-white rounded-lg font-medium hover:bg-[#0A4A30] transition-colors",disabled:me,children:p(me?"productsPage.loading":"productsPage.show")})]})]}),t.jsx("div",{className:"flex gap-2 mb-4 lg:hidden relative",children:t.jsxs("div",{className:"flex gap-2 w-full",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("button",{onClick:()=>x(!S),className:`${S&&"rounded-b-none border-b-0"} flex items-center  justify-center gap-2 py-2 px-4 border border-gray-300 rounded-md bg-white hover:bg-gray-50 transition-all duration-500 w-full`,children:[t.jsx(nt,{className:"w-4 h-4 flex-shrink-0"}),t.jsx("span",{className:"whitespace-nowrap",children:p("productsPage.sorting")})]}),t.jsx("div",{className:`overflow-hidden transition-all duration-500 rounded-b-lg ${S?"max-h-80 opacity-100":"max-h-0 opacity-0"}`,children:t.jsx("div",{className:"border border-gray-300 border-t-0 rounded-b-lg bg-white shadow-lg",children:t.jsx("div",{className:"py-2 rounded-b-lg",children:[{value:null,label:p("sortBy")},{value:"price_asc",label:p("priceLowToHigh")},{value:"price_desc",label:p("priceHighToLow")},{value:"name_asc",label:p("nameAToZ")},{value:"name_desc",label:p("nameZToA")}].map(i=>t.jsx("button",{className:`w-full text-start px-4 py-2 hover:bg-gray-50 transition-colors duration-200 ${s===i.value?"bg-gray-100 font-medium":""}`,onClick:()=>{e&&e({target:{value:i.value}}),x(!1)},children:i.label},i.value))})})})]}),t.jsxs("button",{onClick:()=>O(!0),className:`flex items-center justify-center gap-2 rounded-md bg-[#197853] text-white hover:bg-[#0A4A30] transition-all duration-500 overflow-hidden min-w-0 ${S?"flex-shrink-[999] w-0 p-0 opacity-0":"flex-1 opacity-100"}`,children:[t.jsx(De,{className:`w-4 h-4 flex-shrink-0 transition-opacity duration-300 ${S?"opacity-0":"opacity-100"}`}),t.jsx("span",{className:`whitespace-nowrap transition-opacity duration-300 ${S?"opacity-0":"opacity-100"}`,children:p("productsPage.filteringBtn")})]})]})})]})}const ut=he.memo(()=>t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[t.jsx("div",{className:"w-full aspect-square bg-gray-200 animate-pulse"}),t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),t.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-1/2"}),t.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse w-1/3"})]})]}));function wt(){const{slug:r}=Ie(),[o]=Me(),s=Ve(),{t:e}=Ne(),d=s.state||null,[f,p]=a.useState(!1),[L,S]=a.useState(""),x=o.get("search"),E=o.get("category"),O=o.get("brand"),{brandSlug:D,isHotDeals:k,isRecommended:F,isBrand:K,isSearch:T,isSpecialSlug:j}=a.useMemo(()=>{const u=s.pathname.split("/"),P=u.includes("brand"),H=P?u[u.indexOf("brand")+1]:null,U=r==="hot-deals",J=r==="recommended",ue=P&&H,oe=!!x;return{brandSlug:H,isHotDeals:U,isRecommended:J,isBrand:ue,isSearch:oe,isSpecialSlug:U||J||ue||oe||!!E||!!O}},[s.pathname,r,x,E,O]),A=a.useMemo(()=>k?e("productsPage.hotDeals"):F?e("productsPage.recommended"):K?D?.charAt(0).toUpperCase()+D?.slice(1):T?e("productsPage.searchResultsFor",{query:x}):r?.replace(/-/g," ").replace(/\b\w/g,u=>u.toUpperCase())||e("allProducts"),[k,F,K,T,D,x,r,e]),[g,M]=a.useState(1),[v]=a.useState(10),[R,C]=a.useState(!0),[B,Q]=a.useState([]),[Y,ve]=a.useState(0),[$,W]=a.useState(!1),[z,V]=a.useState(!1),[de,q]=a.useState(null),[me,_]=a.useState(new Set),[Z]=a.useState(()=>Re.isAuthenticated()),{data:ae,isFetching:ne}=Be({searchTerm:x,page:g,pageSize:v},{skip:!T||!x||$}),{data:ee,isFetching:G}=Ye({categorySlug:r,page:g,pageSize:v},{skip:!r||j||$}),{data:se,isFetching:X}=ze({page:g,pageSize:v},{skip:!k||$}),{data:re,isFetching:ge}=He({page:g,pageSize:v},{skip:!F||$}),{data:te,isFetching:ie}=Ue({brandSlug:D,page:g,pageSize:v},{skip:!K||$}),{data:le,isFetching:xe}=Qe({page:g,pageSize:v},{skip:!!r||j||$}),{data:i}=Ce(),{data:n}=Ge(),[y]=We(),[w]=qe(),N=ne||G||X||ge||ie||xe,l=a.useMemo(()=>!r||!i||j?null:i.find(P=>P.slug?.toLowerCase()===r.toLowerCase())?.id,[r,i,j]),c=a.useCallback(u=>{q(u.target.value),M(1)},[]),h=a.useCallback(u=>{if(u===null)W(!1),M(1);else{W(!0);const P=u.products||[],H=u.totalCount||0;ve(H),Q(g===1?P:J=>{const ue=new Set(J.map(ce=>ce.id)),oe=P.filter(ce=>!ue.has(ce.id));return[...J,...oe]});const U=(g-1)*v+P.length;C(U<H&&P.length>0)}},[g,v]),b=a.useCallback(()=>{R&&!N&&M(u=>u+1)},[R,N]);a.useEffect(()=>{if($)return;let u=null;if(T?u=ae:k?u=se:F?u=re:K?u=te:r&&!j?u=ee:u=le,u?.items){const P=u.items,H=u.totalCount||0;g===1?(Q(P),C(P.length<H&&P.length>0)):Q(U=>{const J=new Set(U.map(ce=>ce.id)),ue=P.filter(ce=>!J.has(ce.id)),oe=[...U,...ue];return C(oe.length<H),oe}),ve(H)}else N||C(!1)},[ae,ee,se,re,te,le,g,$]),a.useEffect(()=>{Q([]),M(1),C(!0),W(!1),q(null)},[r,x,D]);const m=a.useCallback(async(u,P,H=1)=>{if(u){_(U=>new Set(U).add(u));try{Z?await y({productId:u,quantity:H}).unwrap():(tt.addItem(P,H),window.dispatchEvent(new Event("cartUpdated")))}catch{Ze.error(e("failedAddToCart"))}finally{_(U=>{const J=new Set(U);return J.delete(u),J})}}},[Z,y,e]),I=a.useCallback(async u=>{try{await w({productId:u}).unwrap()}catch(P){P?.status===401&&(S(e("productsPage.addToCartAction")),p(!0))}},[w,e]),be=u=>n?.includes(u)||!1;return t.jsxs(t.Fragment,{children:[t.jsx(st,{title:A,description:A}),t.jsx(Xe,{isOpen:f,onClose:()=>p(!1),action:L}),t.jsx("div",{className:"min-h-screen bg-[#f7fafc] font-montserrat",children:t.jsxs("div",{className:"mx-auto px-4 py-6 sm:px-6 lg:px-8",children:[t.jsx("div",{className:"hidden lg:block mb-4",children:t.jsx(Je,{categoryData:d?{...d,categoryName:A,categorySlug:r}:null})}),t.jsx("div",{className:"hidden lg:block mb-8",children:t.jsx(ct,{onFilterResults:h,onLoadingChange:V,currentSort:de,onSortChange:c,currentPage:g,setCurrentPage:M,pageSize:v,forcedCategoryId:l,showCategory:!r,isHotDeals:k,isRecommended:F,isBrand:K?D:null,isSearch:x})}),t.jsxs("div",{className:"flex-1",children:[t.jsx(dt,{onFilterResults:h,onLoadingChange:V,currentSort:de,onSortChange:c,currentPage:g,pageSize:v,forcedCategoryId:l}),t.jsx(lt,{dataLength:B.length,next:b,hasMore:R,loader:t.jsx("div",{className:"col-span-full flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}),endMessage:B.length>0&&t.jsx("div",{className:"col-span-full text-center py-8 text-gray-500",children:e("productsPage.noMoreProducts")}),children:t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 lg:gap-6",children:(N||z)&&B.length===0?Array.from({length:10}).map((u,P)=>t.jsx(ut,{},P)):B.length>0?B.map(u=>t.jsx(et,{col:!0,info:{url:u.primaryImageUrl,name:u.name,priceOriginal:u.price,price:u.discountedPrice>0?u.discountedPrice:u.price,id:u.id,description:u.shortDescription},productData:u,handleAddToCart:m,isAddingToCart:me.has(u.id),toggleFavorite:I,isFavorite:be(u.id)},u.id)):!N&&!z&&t.jsx("div",{className:"col-span-full text-center py-12 text-gray-500",children:e("productsPage.noProductsFound")})})})]})]})})]})}export{wt as default};
