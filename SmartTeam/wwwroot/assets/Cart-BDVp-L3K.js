import{u as ne,r as o,O as ve,H as Ne,P as we,Q as Ce,S as Ae,T as Pe,V as ke,W as Se,Y as De,j as e,L as se,c as Ee,Z as Ie,_ as Fe,X as ie,$ as Te,y as k,U as Le,t as ae,a0 as Re}from"./index-BBhEgxr5.js";import{B as re}from"./Breadcrumb-DITKjOb7.js";import{A as Be}from"./arrow-left-DOrdCakU.js";import{T as oe}from"./trash-2-B6-bQTRC.js";import{S as de}from"./shopping-bag-DhD4ebYR.js";import{M as Me}from"./minus-dSxocdxO.js";import{P as Oe}from"./plus-DLW2TatV.js";import{L as U}from"./loader-circle-Bn7_-Q9n.js";import{C as Ue}from"./credit-card-ouC1eF2G.js";import{C as le}from"./check-BWc_mXJP.js";const ze={isAuthenticated(){const t=document.cookie.split(";");for(let l of t){const[a]=l.trim().split("=");if(a==="token"||a==="authToken"||a==="accessToken"||a==="jwt")return!0}return!1}},R={CART_KEY:"ecommerce_cart",getCart(){try{const t=localStorage.getItem(this.CART_KEY);return t?JSON.parse(t):{items:[],totalPriceBeforeDiscount:0,totalDiscount:0,totalAmount:0}}catch(t){return console.error("Error reading cart:",t),{items:[],totalPriceBeforeDiscount:0,totalDiscount:0,totalAmount:0}}},saveCart(t){try{t.totalPriceBeforeDiscount=t.totalPriceBeforeDiscount||0,t.totalDiscount=t.totalDiscount||0,t.totalAmount=t.totalAmount||0,localStorage.setItem(this.CART_KEY,JSON.stringify(t)),window.dispatchEvent(new CustomEvent("cartUpdated",{detail:t}))}catch(l){console.error("Error saving cart:",l)}},removeItem(t){const l=this.getCart();return l.items=l.items.filter(a=>a.id!==t),this.updateCartTotals(l),l},updateQuantity(t,l){const a=this.getCart(),f=a.items.find(d=>d.id===t);if(!f)return console.warn(`Item with id ${t} not found`),a;if(l<=0)return this.removeItem(t);f.quantity=l;const x=f.unitPrice+(f.productDiscount||0);return f.totalPriceBeforeDiscount=x*l,f.totalPrice=f.unitPrice*l,this.updateCartTotals(a),a},clearCart(){const t={items:[],totalPriceBeforeDiscount:0,totalDiscount:0,totalAmount:0};localStorage.setItem(this.CART_KEY,JSON.stringify(t)),window.dispatchEvent(new CustomEvent("cartUpdated",{detail:t}))},updateCartTotals(t){const l=t.items.reduce((x,d)=>x+(d.totalPriceBeforeDiscount||0),0),a=t.items.reduce((x,d)=>x+(d.productDiscount||0)*(d.quantity||0),0),f=t.items.reduce((x,d)=>x+(d.totalPrice||0),0);t.totalPriceBeforeDiscount=isNaN(l)?0:l,t.totalDiscount=isNaN(a)?0:a,t.totalAmount=isNaN(f)?0:f,this.saveCart(t)}},We=(t,l)=>{let a;return(...f)=>{clearTimeout(a),a=setTimeout(()=>t.apply(null,f),l)}},Qe=()=>e.jsxs("div",{className:"space-y-4 lg:hidden animate-pulse py-6 border-b border-gray-100 last:border-0",children:[e.jsxs("div",{className:"flex items-start rounded-lg",children:[e.jsx("div",{className:"w-30 h-30 bg-gray-300 rounded-lg mr-4"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-5 bg-gray-300 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/3"})]}),e.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center rounded-full bg-gray-100 p-1",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-8 h-8 bg-gray-300 mx-1 rounded-full"}),e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full"})]}),e.jsx("div",{className:"h-6 bg-gray-300 rounded w-20"})]})]}),_e=()=>e.jsxs("div",{className:"hidden lg:flex flex-col gap-4 animate-pulse bg-white p-6 rounded-3xl h-full",children:[e.jsx("div",{className:"w-full h-48 bg-gray-300 rounded-2xl mx-auto"}),e.jsxs("div",{className:"flex-1 flex flex-col items-center space-y-3 mt-2",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),e.jsx("div",{className:"h-8 bg-gray-300 rounded w-24 my-2"}),e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-full p-1 mt-auto",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-8 h-8 bg-gray-300 mx-2 rounded-full"}),e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full"})]})]})]}),Ze=()=>e.jsxs("div",{className:"lg:bg-white lg:p-6 lg:rounded-2xl flex-2 animate-pulse h-fit",children:[e.jsxs("div",{className:"border-t lg:border-none border-gray-200 pt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-5 bg-gray-300 rounded w-20"}),e.jsx("div",{className:"h-5 bg-gray-300 rounded w-16"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"h-5 bg-gray-300 rounded w-20"}),e.jsx("div",{className:"h-5 bg-gray-300 rounded w-16"})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-200",children:[e.jsx("div",{className:"h-6 bg-gray-300 rounded w-16"}),e.jsx("div",{className:"h-6 bg-gray-300 rounded w-20"})]})]}),e.jsx("div",{className:"w-full h-14 bg-gray-300 rounded-full mt-4"})]}),$e=()=>e.jsxs("div",{className:"flex-5 flex flex-col gap-6",children:[e.jsx("div",{className:"hidden lg:grid grid-cols-2 gap-6",children:[...Array(4)].map((t,l)=>e.jsx(_e,{},l))}),e.jsx("div",{className:"lg:hidden space-y-4 bg-white p-6 rounded-2xl",children:[...Array(3)].map((t,l)=>e.jsx(Qe,{},l))})]}),Ge=({isOpen:t,onClose:l,cartItems:a,onSubmit:f,isSubmitting:x,isSuccess:d,me:i})=>{const{t:n}=ne(),[u,j]=o.useState({customerName:"",customerPhone:"",deliveryAddress:"",deliveryNotes:"",latitude:40.4093,longitude:49.8671,useWalletAmount:0}),{data:w}=Re(void 0,{skip:!i});o.useEffect(()=>{t&&i&&j(g=>({...g,customerName:g.customerName||(i.firstName+" "+(i.lastName||"")).trim(),customerPhone:g.customerPhone||i.phoneNumber||""}))},[t,i]);const[E,N]=o.useState(""),C=o.useRef(null),z=o.useRef(null),S=o.useRef(null);if(o.useEffect(()=>{if(t&&S.current&&!C.current){const g=setTimeout(()=>{const v=L.map(S.current).setView([u.latitude,u.longitude],13);C.current=v,L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(v);const b=L.marker([u.latitude,u.longitude],{draggable:!0}).addTo(v);z.current=b,L.Control.geocoder({defaultMarkGeocode:!1}).on("markgeocode",function(p){const y=p.geocode.bbox,I=L.polygon([y.getSouthEast(),y.getNorthEast(),y.getNorthWest(),y.getSouthWest()]);v.fitBounds(I.getBounds());const F=p.geocode.center;b.setLatLng(F),j(Q=>({...Q,latitude:F.lat,longitude:F.lng,deliveryAddress:p.geocode.name}))}).addTo(v),b.on("dragend",function(p){const y=b.getLatLng();j(I=>({...I,latitude:y.lat,longitude:y.lng}))}),v.on("click",function(p){b.setLatLng(p.latlng),j(y=>({...y,latitude:p.latlng.lat,longitude:p.latlng.lng}))})},100);return()=>{clearTimeout(g),C.current&&(C.current.remove(),C.current=null)}}},[t]),!t)return null;const A=g=>{const{name:v,value:b}=g.target;j(p=>({...p,[v]:b})),N("")},W=()=>{const g=a?.finalAmount||a?.totalAmount||0;return u.customerName.trim()?u.customerPhone.trim()?u.deliveryAddress.trim()?u.useWalletAmount>g?(N(n("walletExceed")),!1):w&&u.useWalletAmount>w.balance?(N(n("insufficientBalance")),!1):!0:(N(n("enterAddress")),!1):(N(n("enterPhone")),!1):(N(n("enterName")),!1)},D=g=>{g.preventDefault(),W()&&f(u)},B=()=>{x||(j({customerName:"",customerPhone:"",deliveryAddress:"",deliveryNotes:"",latitude:40.4093,longitude:49.8671,useWalletAmount:0}),N(""),l())};return e.jsx("div",{className:"fixed inset-0 bg-black/60 z-[9999] flex items-center justify-center p-4 backdrop-blur-sm",onClick:B,children:e.jsxs("div",{className:"bg-white rounded-3xl max-w-2xl w-full shadow-2xl max-h-[90vh] overflow-y-auto",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 sticky top-0 bg-white z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-50 rounded-full",children:e.jsx(de,{className:"w-5 h-5 text-[#197853]"})}),e.jsx("h3",{className:"text-xl font-bold text-[#197853]",style:{fontFamily:"Montserrat, sans-serif"},children:n("finalizeOrder")})]}),e.jsx("button",{onClick:B,disabled:x,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50 p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ie,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n("fullName")," ",e.jsx("span",{className:"text-[#197853]",children:"*"})]}),e.jsx("input",{type:"text",id:"customerName",name:"customerName",value:u.customerName,onChange:A,disabled:x||d,placeholder:n("nameSurnamePlaceholder"),className:"w-full px-5 py-3 bg-gray-50 border-transparent rounded-2xl focus:ring-2 focus:ring-[#197853] focus:bg-white transition-all font-medium"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"customerPhone",className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n("profile.phone")," ",e.jsx("span",{className:"text-[#197853]",children:"*"})]}),e.jsx("input",{type:"tel",id:"customerPhone",name:"customerPhone",value:u.customerPhone,onChange:A,disabled:x||d,placeholder:"+994",className:"w-full px-5 py-3 bg-gray-50 border-transparent rounded-2xl focus:ring-2 focus:ring-[#197853] focus:bg-white transition-all font-medium"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"deliveryAddress",className:"block text-sm font-medium text-gray-700 mb-1.5",children:[n("deliveryAddress")," ",e.jsx("span",{className:"text-[#197853]",children:"*"})]}),e.jsx("input",{type:"text",id:"deliveryAddress",name:"deliveryAddress",value:u.deliveryAddress,onChange:A,disabled:x||d,placeholder:n("addressPlaceholder"),className:"w-full px-5 py-3 bg-gray-50 border-transparent rounded-2xl focus:ring-2 focus:ring-[#197853] focus:bg-white transition-all font-medium"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"deliveryNotes",className:"block text-sm font-medium text-gray-700 mb-1.5",children:n("orderNotes")}),e.jsx("textarea",{id:"deliveryNotes",name:"deliveryNotes",value:u.deliveryNotes,onChange:A,disabled:x||d,placeholder:n("extraInfoPlaceholder"),rows:"3",className:"w-full px-5 py-3 bg-gray-50 border-transparent rounded-2xl focus:ring-2 focus:ring-[#197853] focus:bg-white transition-all font-medium resize-none"})]})]}),e.jsxs("div",{className:"space-y-4",children:[w&&e.jsxs("div",{className:"p-4 bg-[#197853]/5 rounded-2xl border border-[#197853]/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-[#197853]"}),e.jsx("span",{className:"text-sm font-semibold text-[#197853]",children:n("useWallet")})]}),e.jsxs("span",{className:"text-xs font-bold text-[#1A8B5E]",children:[n("availableBalance"),": ₼ ",w.balance?.toFixed(2)]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",name:"useWalletAmount",value:u.useWalletAmount,onChange:g=>{A(g)},max:w.balance,step:"0.01",disabled:x||d,placeholder:"0.00",className:"w-full pl-5 pr-14 py-3 bg-white border border-gray-100 rounded-xl focus:ring-2 focus:ring-[#197853] outline-none font-bold"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-sm font-bold text-gray-400",children:"AZN"})]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-2 italic",children:n("walletNote")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:n("markAddressOnMap")}),e.jsx("div",{ref:S,className:"w-full h-[300px] border border-gray-200 rounded-2xl overflow-hidden z-0"}),e.jsx("p",{className:"text-xs text-gray-500 italic",children:n("mapTip")})]})]})]}),E&&e.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-2xl text-sm font-medium",children:E}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6 pt-6 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:n("amountToPay")}),e.jsxs("p",{className:"text-3xl font-bold text-[#197853]",children:[Math.max(0,(a?.finalAmount||a?.totalAmount||0)-(u.useWalletAmount||0)).toFixed(2)," AZN"]}),u.useWalletAmount>0&&e.jsxs("p",{className:"text-xs text-green-600 font-medium mt-1",children:["(- ₼ ",parseFloat(u.useWalletAmount).toFixed(2)," ",n("fromBalance"),")"]})]}),e.jsx("button",{type:"submit",disabled:x||d,className:`min-w-[200px] py-4 px-8 rounded-full font-bold text-lg transition-all duration-300 flex items-center justify-center gap-2 shadow-lg active:scale-[0.98] ${d?"bg-green-500 text-white":"bg-[#197853] hover:bg-[#0A4A30] text-white"}`,children:x?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-6 h-6 animate-spin"}),n("wait")]}):d?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-6 h-6"}),n("completed")]}):e.jsxs(e.Fragment,{children:[n("confirmOrder"),e.jsx(le,{className:"w-5 h-5"})]})})]})]})]})})},at=()=>{const{t,i18n:l}=ne(),[a,f]=o.useState(!1),[x,d]=o.useState({items:[],totalPriceBeforeDiscount:0,totalDiscount:0,totalAmount:0}),[i,n]=o.useState(null),[u,j]=o.useState(!1),[w,E]=o.useState(!1),[N,C]=o.useState(!1),[z,S]=o.useState(!1),[A,W]=o.useState(""),{data:D,isLoading:B,isError:g}=ve(void 0,{skip:!a}),{data:v}=Ne(),{data:b}=we(),[p]=Ce(),[y]=Ae(),[I]=Pe(),[F]=ke(),[Q]=Se(),[ce]=De(),[M,$]=o.useState(""),[G,Y]=o.useState(!1),[K,J]=o.useState(!1),[me,q]=o.useState(new Set),[V,H]=o.useState(!1),[_,Z]=o.useState({}),[ue,X]=o.useState(new Set);o.useEffect(()=>{const s=ze.isAuthenticated();f(s),s||d(R.getCart())},[]),o.useEffect(()=>{if(!a){const s=r=>{d(r.detail)};return window.addEventListener("cartUpdated",s),()=>window.removeEventListener("cartUpdated",s)}},[a]);const c=a?D:x,ee=a?B:!1;o.useEffect(()=>{async function s(){if(!c?.items||c.items.length===0){n({items:[],totalPriceBeforeDiscount:0,totalDiscount:0,totalAmount:0});return}const r=l.language;if(r==="en"){const m={...c,items:await Promise.all(c.items.map(async h=>({...h,productName:await ae(h.productName,r),productDescription:h.productDescription?await ae(h.productDescription,r):h.productDescription})))};n(m)}else n(c)}s()},[l.language,c]);const xe=async s=>{E(!0);try{const r={customerName:s.customerName,customerPhone:s.customerPhone,deliveryAddress:s.deliveryAddress,deliveryNotes:s.deliveryNotes,latitude:s.latitude,longitude:s.longitude,useWalletAmount:s.useWalletAmount||0};await F(r).unwrap(),C(!0),setTimeout(async()=>{a||(R.clearCart(),d({items:[],totalPriceBeforeDiscount:0,totalDiscount:0,totalAmount:0})),j(!1),C(!1),k.success(t("orderSuccess"))},1500)}catch(r){console.error("Order creation error:",r),k.error(r?.data?.message||t("orderError")),E(!1)}},te=o.useMemo(()=>We(async(s,r)=>{if(a)try{X(m=>new Set(m).add(s)),await p({cartItemId:s,quantity:r}).unwrap()}catch(m){console.error("Failed to update cart item:",m),Z(h=>{const P={...h};return delete P[s],P})}finally{X(m=>{const h=new Set(m);return h.delete(s),h})}},500),[p,a]);o.useEffect(()=>{a&&D?.items&&Z(s=>{const r={...s};let m=!1;return D.items.forEach(h=>{r[h.id]===h.quantity&&(delete r[h.id],m=!0)}),m?r:s})},[D,a]);const T=o.useCallback(s=>_[s.id]!==void 0?_[s.id]:s.quantity,[_]),O=o.useCallback((s,r)=>{if(!(r<1))if(a)Z(m=>({...m,[s.id]:r})),te(s.id,r);else{const m=R.updateQuantity(s.id,r);d(m)}},[a,te]),he=o.useCallback(s=>{const r=T(s);O(s,r+1)},[T,O]),ge=o.useCallback(s=>{const r=T(s);r>1&&O(s,r-1)},[T,O]),fe=async s=>{try{if(q(r=>new Set(r).add(s)),a)await y({id:s}).unwrap();else{const r=R.removeItem(s);d(r)}}catch(r){console.error("Failed to remove cart item:",r)}finally{q(r=>{const m=new Set(r);return m.delete(s),m})}},pe=async()=>{try{H(!0),a?await I().unwrap():(R.clearCart(),d({items:[],totalPriceBeforeDiscount:0,totalDiscount:0,totalAmount:0}))}catch(s){console.error("Failed to remove cart:",s)}finally{H(!1)}},be=async()=>{if(M.trim())try{Y(!0),await Q({promoCode:M}).unwrap(),k.success(t("promoApplied")||"Promo code applied!"),$("")}catch(s){k.error(s?.data?.message||t("promoFailed")||"Invalid promo code")}finally{Y(!1)}},ye=async()=>{try{J(!0),await ce().unwrap(),k.success(t("promoRemoved")||"Promo code removed")}catch{k.error(t("promoRemoveFailed")||"Failed to remove promo code")}finally{J(!1)}};return g?e.jsx("section",{className:"inter bg-[#f7fafc] min-h-[80vh] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:t("errorLoadingCart")}),e.jsx("p",{className:"text-gray-600",children:t("pleaseTryAgainLater")})]})}):e.jsxs("section",{className:"bg-[#FCFCFC] min-h-[80vh] font-sans pb-12",style:{fontFamily:"Montserrat, sans-serif"},children:[e.jsx("div",{className:"lg:hidden px-4 md:px-8 py-4 lg:bg-white lg:shadow-sm lg:mb-4",children:e.jsx(re,{})}),e.jsxs("div",{className:"min-h-[80vh] lg:max-w-[98vw] lg:mx-auto border-none lg:border-0 p-0",children:[e.jsx("div",{className:"p-4 pl-7 pb-0 hidden lg:block",children:e.jsx(re,{})}),e.jsx("div",{className:"p-4 md:px-8 text-2xl font-bold bg-transparent border-none mb-6 text-[#197853]",children:ee?e.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 animate-pulse"}):e.jsxs("h1",{children:[t("myCart")," ",e.jsxs("span",{className:"text-gray-400 font-normal text-lg",children:["(",(i||c)?.items?.length||0," ",t("items"),")"]})]})}),e.jsx("div",{className:"flex flex-col lg:flex-row gap-6 lg:gap-8 px-4 md:px-8",children:ee?e.jsxs(e.Fragment,{children:[e.jsx($e,{}),e.jsx(Ze,{})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-5 flex flex-col gap-6",children:[(i||c)?.items?.length>0&&e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs(se,{to:"/",className:"flex items-center gap-2 text-gray-600 hover:text-[#197853] transition-colors bg-white px-4 py-2 rounded-full shadow-sm",children:[e.jsx(Be,{size:18}),e.jsx("p",{className:"font-medium text-sm",children:t("backToShop")})]}),e.jsxs("button",{onClick:()=>pe(),className:"px-4 py-2 bg-white hover:bg-red-50 cursor-pointer text-red-500 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium shadow-sm flex items-center gap-2",disabled:V,children:[e.jsx(oe,{size:16}),t(V?"removingAll":"removeAll")]})]}),(i||c)?.items?.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center shadow-sm",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(de,{className:"w-10 h-10 text-gray-300"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:t("yourCartIsEmpty")}),e.jsx("p",{className:"text-gray-500 mb-8",children:t("addItemsToStart")}),e.jsx(se,{to:"/",className:"inline-flex items-center justify-center px-8 py-3 bg-[#197853] text-white font-semibold rounded-full hover:bg-[#0A4A30] transition-colors shadow-lg shadow-[#197853]/20",children:t("startShopping")||"Start Shopping"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:(i||c)?.items?.map((s,r)=>{const m=T(s),h=ue.has(s.id),P=me.has(s.id);return e.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-sm hover:shadow-md transition-all duration-300 flex flex-col relative group border border-gray-50",children:[e.jsx("div",{className:"w-full aspect-square bg-gray-50 rounded-xl p-2 flex items-center justify-center mb-3 relative overflow-hidden",children:e.jsx("img",{className:"w-full h-full object-contain transform group-hover:scale-105 transition-transform duration-500",src:`${Ee}/${s?.productImageUrl}`,alt:s?.productName||"Product",onError:je=>{je.currentTarget.src="/Icons/logo.png"}})}),e.jsxs("div",{className:"flex-1 flex flex-col text-center",children:[e.jsx("h3",{className:"font-bold text-sm text-[#197853] mb-1 line-clamp-2 leading-tight min-h-[2.5em]",children:s.productName}),s.productDescription&&e.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-2 mb-2 px-1 leading-relaxed",children:s.productDescription}),e.jsx("div",{className:"mt-auto mb-3",children:e.jsxs("span",{className:"text-lg font-bold text-[#197853]",children:[(s.unitPrice*m).toFixed(2)," ₼"]})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("div",{className:"flex items-center justify-center bg-gray-50 rounded-full p-1 w-fit shadow-inner",children:[e.jsx("button",{className:"w-6 h-6 flex items-center justify-center bg-white rounded-full text-gray-500 shadow-sm hover:text-[#197853] hover:scale-105 active:scale-95 disabled:opacity-50 transition-all",onClick:()=>ge(s),disabled:m<=1||h||P,children:e.jsx(Me,{size:12})}),e.jsx("span",{className:`w-8 text-center text-xs font-bold text-gray-900 ${h?"opacity-50":""}`,children:m}),e.jsx("button",{className:"w-6 h-6 flex items-center justify-center bg-white rounded-full text-gray-500 shadow-sm hover:text-[#197853] hover:scale-105 active:scale-95 disabled:opacity-50 transition-all",onClick:()=>he(s),disabled:h||P,children:e.jsx(Oe,{size:12})})]}),e.jsx("button",{onClick:()=>fe(s.id),className:"w-8 h-8 flex items-center justify-center bg-red-50 text-red-500 rounded-full hover:bg-red-100 transition-colors disabled:opacity-50",disabled:P||h,title:t("remove"),children:P?e.jsx(U,{size:14,className:"animate-spin"}):e.jsx(oe,{size:14})})]})]})]},s.id)})})]}),e.jsxs("div",{className:"bg-white p-8 rounded-2xl h-fit w-full lg:w-96 flex-shrink-0",children:[e.jsxs("div",{className:"border-b border-gray-100 pb-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-gray-600 text-base font-medium",children:[e.jsxs("span",{children:[t("subtotal"),":"]}),e.jsxs("span",{children:[((i||c)?.totalPriceBeforeDiscount||0).toFixed(2)," AZN"]})]}),((i||c)?.totalDiscount||0)>0&&e.jsxs("div",{className:"flex justify-between text-[#197853] text-base font-medium",children:[e.jsxs("span",{children:[t("discount"),":"]}),e.jsxs("span",{children:["- ",((i||c)?.totalDiscount||0).toFixed(2)," AZN"]})]}),a&&e.jsx("div",{className:"pt-2",children:(i||c)?.appliedPromoCode?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-100 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-bold uppercase",children:(i||c)?.appliedPromoCode}),e.jsxs("p",{className:"text-[10px] text-green-500",children:[(i||c)?.promoCodeDiscountPercentage,"% ",t("discountApplied")||"discount applied"]})]})]}),e.jsx("button",{onClick:ye,disabled:K,className:"p-1.5 hover:bg-green-100 rounded-lg transition-colors",children:K?e.jsx(U,{className:"w-3 h-3 animate-spin text-green-600"}):e.jsx(ie,{className:"w-4 h-4 text-green-600"})})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:t("enterPromo")||"Promo code",value:M,onChange:s=>$(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg min-w-[150px] text-sm focus:outline-none focus:ring-1 focus:ring-[#197853]"})]}),e.jsx("button",{onClick:be,disabled:G||!M.trim(),className:"px-4 py-2 bg-[#197853] text-white rounded-lg text-sm font-semibold hover:bg-[#0A4A30] transition-colors disabled:opacity-50",children:G?e.jsx(U,{className:"w-4 h-4 animate-spin"}):t("apply")})]})}),((i||c)?.promoCodeDiscountAmount||0)>0&&e.jsxs("div",{className:"flex justify-between text-green-600 text-base font-medium",children:[e.jsxs("span",{children:[t("promoDiscount"),":"]}),e.jsxs("span",{children:["- ",((i||c)?.promoCodeDiscountAmount||0).toFixed(2)," AZN"]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold text-[#197853] pt-4",children:[e.jsxs("span",{children:[t("total"),":"]}),e.jsxs("span",{children:[((i||c)?.finalAmount||(i||c)?.totalAmount||0).toFixed(2)," AZN"]})]})]}),e.jsxs("button",{onClick:()=>{if(a){const s=(i||c)?.finalAmount||(i||c)?.totalAmount||0;if(b?.isMinimumOrderAmountEnabled&&s<b.minimumOrderAmount){k.error(t("minimumOrderAmountError",{amount:b.minimumOrderAmount.toFixed(2),total:s.toFixed(2)}));return}j(!0)}else W(t("productsPage.addToCartAction")),S(!0)},className:"w-full mt-6 cursor-pointer bg-[#197853] hover:bg-[#0A4A30] text-white font-semibold py-4 px-6 rounded-full transition-all shadow-md hover:shadow-lg flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed transform active:scale-95",disabled:!(i||c)?.items?.length,children:[e.jsx(Te,{size:20}),e.jsx("span",{children:t("buyNow")})]})]})]})})]}),e.jsx(Ge,{isOpen:u,onClose:()=>{w||j(!1)},cartItems:i||c,onSubmit:xe,isSubmitting:w,isSuccess:N,me:v}),e.jsx(Le,{isOpen:z,onClose:()=>S(!1),action:A})]})};export{at as default};
