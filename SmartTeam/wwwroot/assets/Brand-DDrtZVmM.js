import{bh as O,r as m,j as e,y as p,bi as k,c as y,X as B,u as F,f as S,bj as U}from"./index-BBhEgxr5.js";import{M as w}from"./Modal-GV133dSV.js";import{U as v}from"./upload-BU2oQTXe.js";import{T as C}from"./trash-2-B6-bQTRC.js";import{L as N}from"./loader-circle-Bn7_-Q9n.js";const D=({setOpen:s})=>{const[x,{isLoading:u}]=O(),[t,r]=m.useState(null),[b,o]=m.useState(null),[l,h]=m.useState({name:"",sortOrder:1}),g=a=>{const d=a.target.files[0];d&&(r(d),a.target.value="")};m.useEffect(()=>{if(t){const a=URL.createObjectURL(t);return o(a),()=>{URL.revokeObjectURL(a)}}else o(null)},[t]);const f=async a=>{if(a.preventDefault(),!t){p.error("Zəhmət olmasa əvvəlcə şəkil yükləyin");return}try{const d={name:l.name,sortOrder:l.sortOrder},i=new FormData;i.append("name",l.name),i.append("sortOrder",l.sortOrder),i.append("imageFile",t,t.name);const c=await x({name:l.name,sortOrder:l.sortOrder,file:t}).unwrap();p.success("Brend uğurla əlavə edildi"),h({name:"",sortOrder:1}),r(null),s()}catch(d){p.error(d?.data||"Nəsə səhv getdi")}},n=a=>{const{name:d,value:i}=a.target;h({...l,[d]:i})};return e.jsxs("form",{onSubmit:f,className:"flex flex-col gap-6 p-6 bg-[#1f1f1f] rounded-lg w-96",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-white text-sm mb-1",htmlFor:"name",children:["Ad ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"name",onChange:n,name:"name",type:"text",required:!0,placeholder:"Brend adını daxil edin",className:"w-full px-4 py-3 rounded-lg bg-[#2a2a2a] text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white placeholder:text-gray-400"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-white text-sm mb-1",htmlFor:"sortOrder",children:"Sıra nömrəsi"}),e.jsx("input",{id:"sortOrder",onChange:n,name:"sortOrder",type:"number",value:l.sortOrder,className:"w-full px-4 py-3 rounded-lg bg-[#2a2a2a] text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Brend loqosu"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden",id:"image-upload"}),e.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer flex flex-col items-center gap-2",children:[e.jsx(v,{className:"w-8 h-8 text-gray-400"}),e.jsx("span",{className:"text-gray-400",children:"Şəkil yükləmək üçün klik edin və ya sürükləyin"}),e.jsx("span",{className:"text-sm text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})]}),t&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:b,className:"w-full h-24 object-cover rounded-md border",alt:"Preview"}),e.jsx("button",{type:"button",onClick:()=>{r(null)},className:"absolute top-1 right-1 bg-red-600 hover:bg-red-700 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(C,{className:"w-3 h-3"})})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:u,className:"px-6 py-3 bg-white text-black font-semibold rounded-lg hover:bg-gray-200 transition-all",children:u?e.jsx(N,{className:"w-12 h-12 text-white animate-spin"}):"Yadda saxla"})})]})},I=({item:s,setOpen:x})=>{const[u,{isLoading:t}]=k(),[r,b]=m.useState({name:"",sortOrder:0}),[o,l]=m.useState(null),[h,g]=m.useState(null);m.useEffect(()=>{s&&(b({name:s.name||"",sortOrder:s.sortOrder||0}),s.logoUrl&&g(`${y}/${s.logoUrl}`))},[s]);const f=async i=>{i.preventDefault();try{const c={name:r.name,isActive:!0,sortOrder:Number(r.sortOrder)};await u({id:s.id,brandData:c,imageFile:o}).unwrap(),p.success("Brend uğurla yeniləndi"),x()}catch(c){p.error(c?.data?.message||"Brendi yeniləmək uğursuz oldu")}},n=i=>{const{name:c,value:j}=i.target;b({...r,[c]:j})},a=i=>{const c=i.target.files?.[0];if(c){l(c);const j=new FileReader;j.onloadend=()=>{g(j.result)},j.readAsDataURL(c)}},d=()=>{l(null),g(s?.logoUrl?`${y}/${s.logoUrl}`:null)};return e.jsxs("form",{onSubmit:f,className:"flex flex-col gap-6 p-6 bg-[#1f1f1f] rounded-lg w-96",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-white text-sm mb-1",htmlFor:"name",children:["Ad ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"name",onChange:n,name:"name",type:"text",required:!0,value:r.name,className:"w-full px-4 py-3 rounded-lg bg-[#2a2a2a] text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white placeholder:text-gray-400"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-white text-sm mb-1",htmlFor:"sortOrder",children:"Sıra nömrəsi"}),e.jsx("input",{id:"sortOrder",onChange:n,name:"sortOrder",type:"number",value:r.sortOrder,className:"w-full px-4 py-3 rounded-lg bg-[#2a2a2a] text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white placeholder:text-gray-400"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-white text-sm mb-2",children:"Brend loqosu"}),h&&e.jsxs("div",{className:"relative mb-3",children:[e.jsx("img",{src:h,alt:"Brand logo preview",className:"relative w-32 h-32 mx-auto object-cover rounded-lg border-2 border-gray-700"}),e.jsx("button",{type:"button",onClick:d,className:"absolute -top-2 right-24 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition",children:e.jsx(B,{className:"w-4 h-4"})})]}),e.jsxs("label",{htmlFor:"imageFile",className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#2a2a2a] text-white rounded-lg border border-gray-700 hover:bg-[#333] cursor-pointer transition",children:[e.jsx(v,{className:"w-5 h-5"}),e.jsx("span",{children:o?"Şəkli dəyişdir":"Şəkil yüklə"})]}),e.jsx("input",{id:"imageFile",type:"file",accept:"image/*",onChange:a,className:"hidden"}),o&&e.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Seçildi: ",o.name]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:x,className:"px-6 py-3 bg-gray-700 text-white font-semibold rounded-lg hover:bg-gray-600 transition-all",children:"Ləğv et"}),e.jsx("button",{type:"submit",disabled:t,className:"px-6 py-3 bg-white text-black font-semibold rounded-lg hover:bg-gray-200 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:t?e.jsx(N,{className:"w-6 h-6 text-black animate-spin"}):"Yadda saxla"})]})]})},M=()=>{const{t:s}=F(),[x,u]=m.useState(null),[t,r]=m.useState(null),{data:b,isLoading:o,error:l,refetch:h}=S(),[g]=U(),f=async a=>{try{await g({id:a}).unwrap(),p.success(s("admin.brandDeletedSuccess")),n()}catch(d){p.error(d?.data||s("admin.deletingBrandFailed"))}},n=()=>{u(null),r(null),h()};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold !text-white",children:s("admin.brands")}),e.jsx("button",{onClick:()=>u("add"),className:"px-6 py-3 font-semibold rounded-lg bg-white text-black hover:bg-gray-200 transition-all",children:s("admin.addNewBrand")})]}),e.jsx(w,{open:x==="add",setOpen:n,children:e.jsx(D,{setOpen:n})}),e.jsx(w,{open:x==="edit",setOpen:n,children:!o&&e.jsx(I,{setOpen:n,item:t})}),e.jsx("ul",{className:"space-y-4",children:o?e.jsx(N,{className:"w-12 h-12 text-white animate-spin"}):b?.map(a=>e.jsx("li",{className:"flex flex-col bg-[#1f1f1f] text-white rounded-xl shadow hover:shadow-lg transition-all",children:e.jsxs("div",{className:"flex justify-between items-center p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{className:"w-10 h-10 rounded-full",src:`${y}/${a.logoUrl}`||"https://static.nike.com/a/images/c_limit,w_592,f_auto/t_product_v1/u_126ab356-44d8-4a06-89b4-fcdcc8df0245,c_scale,fl_relative,w_1.0,h_1.0,fl_layer_apply/85d1d12f-b0a5-49c0-bc81-6238cfc5d9ac/JORDAN+1+RETRO+HIGH+OG+%28PS%29.png",alt:""}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium !text-white",children:a.name}),e.jsx("p",{className:"text-sm text-gray-400",children:a.slug||"slug"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{u("edit"),r(a)},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition",children:"Redaktə et"}),e.jsx("button",{onClick:()=>f(a.id),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition",children:"Sil"})]})]})},a.id))})]})};export{M as default};
