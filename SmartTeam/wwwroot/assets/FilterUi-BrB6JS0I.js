import{r as l,n as $,aY as q,aZ as B,a_ as H,a$ as K,b0 as V,j as e,X as W,y as d}from"./index-DXStjdCc.js";import{P as ee}from"./plus-L2CRyHr_.js";import{L as se}from"./loader-circle-Do0avO8G.js";import{C as te}from"./chevron-up-DGkpZrnm.js";import{C as ae}from"./chevron-down-B4kPK6ik.js";import{P as re}from"./pen-CEf8liIv.js";import{T as N}from"./trash-2-CQHjR2Pa.js";import{S as ie}from"./save-C0vadxcq.js";const ge=()=>{const[x,g]=l.useState(null),[M,w]=l.useState(!1),[i,U]=l.useState("add"),[O,F]=l.useState(!1),[S,D]=l.useState({}),{data:L,isLoading:E,refetch:p}=$(),[I]=q(),[J]=B(),[P]=H(),[R,{isLoading:z}]=K(),[T]=V(),[c,n]=l.useState([]),[h,b]=l.useState([]),[r,y]=l.useState({name:"",type:0,isActive:!0,sortOrder:0,options:[]}),[o,m]=l.useState({value:"",displayName:"",color:"",iconUrl:"",isActive:!0,sortOrder:0}),Y=s=>{D(t=>({...t,[s]:!t[s]}))},k=(s,t=null)=>{if(U(s),t){y({name:t.name??"",type:t.type??0,value:t.slug??"",isActive:t.isActive??!0,sortOrder:t.sortOrder??0,options:Array.isArray(t.options)?[...t.options]:[]});const a=Array.isArray(t.options)?[...t.options]:[];n(a),b(JSON.parse(JSON.stringify(a))),g(t)}else y({name:"",value:"",type:0,isActive:!0,sortOrder:0,options:[]}),n([]),b([]),g(null);w(!0)},v=()=>{w(!1),g(null),m({value:"",displayName:"",color:"red",iconUrl:"",isActive:!0,sortOrder:0}),n([]),b([])},j=s=>{const{name:t,value:a,type:u,checked:A}=s.target,f=u==="checkbox"?A:u==="number"?Number(a):a;y(_=>({..._,[t]:f}))},G=()=>{if(!o.displayName||!o.value)return;const s={...o,id:Date.now()};n(t=>[...t,s]),m({value:"",displayName:"",color:"red",iconUrl:"",isActive:!0,sortOrder:0})},Q=s=>{n(t=>t.filter(a=>a.id!==s))},X=async()=>{F(!0);try{if(i==="add")await I({name:r.name,type:r.type,isActive:r.isActive,sortOrder:r.sortOrder??0,options:c,slug:r.value||"new-filter"}).unwrap(),d.success("Filtr uğurla əlavə olundu!");else if(i==="edit"){await J({id:x.id,name:r.name,type:r.type,isActive:r.isActive,sortOrder:r.sortOrder??0}).unwrap();const s=h.map(a=>a.id),t=c.map(a=>a.id);for(const a of c)if(s.includes(a.id)){const u=h.find(f=>f.id===a.id);JSON.stringify(u)!==JSON.stringify(a)&&await P({filterId:x.id,optionId:a.id,value:a.value,displayName:a.displayName,color:a.color||"red",iconUrl:a.iconUrl||"",isActive:a.isActive,sortOrder:a.sortOrder??0}).unwrap()}for(const a of h)t.includes(a.id)||await C(x.id,a.id);d.success("Filtr uğurla yeniləndi!")}p(),v()}catch(s){console.error("submit error",s),d.error(s?.data?.message||s?.data||"Əməliyyat uğursuz oldu")}F(!1)},Z=async s=>{try{await R({id:s}).unwrap(),d.success("Filtr uğurla silindi"),p()}catch(t){console.error(t),d.error(t?.data?.message||"Filtri silmək alınmadı")}},C=async(s,t)=>{try{await T({filterId:s,optionId:t}).unwrap(),d.success("Seçim uğurla silindi"),p()}catch(a){console.error(a),d.error(a?.data?.message||"Seçimi silmək alınmadı")}};return e.jsx("div",{className:"min-h-screen bg-[#181818] text-white p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold !text-white mb-2",children:"Filterlərin idarə edilməsi"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Məhsul filtrlərini və onların seçimlərini idarə et"})]}),e.jsxs("button",{onClick:()=>k("add"),className:"px-6 py-3 bg-white text-gray-900 font-semibold rounded-lg shadow-lg flex items-center gap-2 hover:bg-gray-100 transition-all duration-200",children:[e.jsx(ee,{className:"w-5 h-5"})," Filtr əlavə et"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-xl shadow-lg border border-gray-700",children:e.jsx("div",{className:"divide-y divide-gray-700",children:E?e.jsx("div",{className:"p-6 flex justify-center",children:e.jsx(se,{className:"w-12 h-12 animate-spin text-indigo-500"})}):L?.map(s=>e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>Y(s.id),className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:S[s.id]?e.jsx(te,{className:"w-5 h-5 text-gray-400"}):e.jsx(ae,{className:"w-5 h-5 text-gray-400"})}),e.jsx("div",{children:e.jsx("div",{className:"flex items-center gap-3 mb-1",children:e.jsx("h3",{className:"text-xl font-semibold !text-white",children:s.name})})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>k("edit",s),className:"p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-lg transform hover:scale-110 transition-all duration-200",title:"Edit",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Z(s.id),disabled:z,className:"p-3 bg-red-600 hover:bg-red-700 text-white rounded-lg shadow-lg transform hover:scale-110 transition-all duration-200",title:"Delete",children:e.jsx(N,{className:"w-4 h-4"})})]})]}),S[s.id]&&Array.isArray(s.options)&&s.options.length>0&&e.jsxs("div",{className:"mt-6 ml-12",children:[e.jsxs("h4",{className:"font-semibold !text-white mb-4 text-lg",children:["Seçimlər (",s.options.length,")"]}),e.jsx("div",{className:"space-y-3",children:s.options.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white text-lg",children:t.displayName??t.label}),e.jsxs("span",{className:"text-gray-400 ml-3",children:["(",t.value,")"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>C(s.id,t.id),className:"p-2 bg-red-600 hover:bg-red-700 text-white rounded-lg shadow-lg transform hover:scale-110 transition-all duration-200",title:"Delete Option",children:e.jsx(N,{className:"w-4 h-4"})})})]},t.id))})]})]},s.id))})}),M&&e.jsx("div",{className:"fixed inset-0  bg-opacity-75 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-gray-800 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold !text-white",children:i==="add"?"Yeni filtr əlavə et":i==="edit"?"Filtri redaktə et":"Filter detalları"}),e.jsx("button",{onClick:v,className:"p-2 hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(W,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Filter adı"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:j,disabled:i==="view",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Slug"}),e.jsx("input",{type:"text",name:"value",value:r.value,onChange:j,disabled:i==="view"||i==="edit",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-600"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sıra nömrəsi"}),e.jsx("input",{type:"number",name:"sortOrder",value:r.sortOrder===0?"":r.sortOrder,onChange:j,disabled:i==="view",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:border-transparent disabled:bg-gray-600",min:"0"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-4",children:"Seçimlər"}),i!=="view"&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",placeholder:"Seçim etiketi",value:o.displayName,onChange:s=>m(t=>({...t,displayName:s.target.value})),className:"flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("input",{type:"text",placeholder:"Seçim dəyəri",value:o.value,onChange:s=>m(t=>({...t,value:s.target.value})),className:"flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("button",{type:"button",onClick:G,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition-colors",children:"Əlavə et"})]}),e.jsx("div",{className:"space-y-3",children:c.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-600 bg-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-white",children:s.displayName}),e.jsxs("span",{className:"text-gray-400 ml-2",children:["(",s.value,")"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:i!=="view"&&e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",onClick:()=>Q(s.id),className:"text-red-400 hover:bg-red-600 hover:text-white p-2 rounded-lg transition-colors",children:e.jsx(N,{className:"w-4 h-4"})})})})]},s.id))})]}),i!=="view"&&e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-600",children:[e.jsx("button",{type:"button",onClick:v,className:"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-semibold transition-colors",children:"Ləğv et"}),e.jsxs("button",{type:"button",onClick:X,disabled:O,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 disabled:opacity-50 font-semibold transition-colors",children:[O&&e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx(ie,{className:"w-4 h-4"}),i==="add"?"Filtri yarat":"Dəyişiklikləri yadda saxla"]})]})]})]})})})]})})};export{ge as default};
