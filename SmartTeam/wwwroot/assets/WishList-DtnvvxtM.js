import{u as M,r as n,h as k,E,a1 as H,i as I,a2 as Q,j as e,L as _,t as v,y as u}from"./index-BBhEgxr5.js";import{B as j}from"./Breadcrumb-DITKjOb7.js";import{S as B}from"./SimilarRecommendedProducts-BrO4r6G5.js";import{P as G}from"./ProductCard-DASSXeP1.js";import{T as O}from"./trash-2-B6-bQTRC.js";import{H as q}from"./heart-BZHibsxU.js";import"./CartUtils-BCvxUx-5.js";import"./check-BWc_mXJP.js";const te=()=>{const{t:r,i18n:x}=M(),[d,p]=n.useState(1),c=20,[w,m]=n.useState(null),[z,g]=n.useState(null),[f,b]=n.useState([]),{data:N,isRecLoading:F}=k({limit:6}),{data:y,isLoading:C,error:T}=E({page:d,pageSize:c}),[A,{isLoading:U}]=H(),[L,{isLoading:W}]=I(),[P]=Q(),i=y?.favorites||[],l=y?.totalCount||0;n.useEffect(()=>{async function t(){if(!i||i.length===0)return;const s=x.language;if(s==="en"){const o=await Promise.all(i.map(async a=>({...a,product:{...a.product,name:await v(a.product.name,s),shortDescription:a.product.shortDescription?await v(a.product.shortDescription,s):a.product.shortDescription}})));b(o)}else b(i)}t()},[x.language,i]);const S=async(t,s)=>{try{await A({productId:s}).unwrap()}catch(o){u.error(r("failedToRemoveFavorite")),console.error("Remove favorite error:",o)}},D=async(t,s,o)=>{const a=o?.minimumOrderQuantity||1;m(s);try{await L({productId:s,quantity:a}).unwrap(),g(s),setTimeout(()=>{g(null),m(null)},2e3)}catch(h){m(null),h?.status===401||h?.data?.status===401?u.error(r("pleaseLoginFirst")):u.error(r("failedToAddToCart")),console.error("Add to cart error:",h)}},R=async()=>{try{await P().unwrap()}catch(t){u.error(r("failedToClearFavorites")),console.error("Clear favorites error:",t)}};return C?e.jsx("section",{className:"inter bg-[#f7fafc] min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-xl",children:r("loadingFavorites")})}):T?e.jsx("section",{className:"inter bg-[#f7fafc] min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-xl text-red-600",children:r("errorLoadingFavorites")})}):e.jsxs("section",{className:"min-h-screen bg-[#f7fafc] pb-8",style:{fontFamily:"Montserrat, sans-serif"},children:[e.jsx("div",{className:"lg:hidden px-4 py-4 bg-white border-b border-[#dee2e6]",children:e.jsx(j,{})}),e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"hidden lg:block mb-4",children:e.jsx(j,{})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-[#197853]",children:[r("favorites")," (",l,")"]}),i?.length>0&&e.jsxs("button",{onClick:R,className:"mt-4 md:mt-0 px-4 py-2 bg-white border border-[#197853]/20 text-[#197853] rounded-lg hover:bg-[#197853]/5 hover:border-[#197853]/40 transition-all duration-300 flex items-center gap-2 shadow-sm",children:[e.jsx(O,{className:"w-4 h-4"}),r("clearAll")]})]}),i?.length===0?e.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl shadow-[0_8px_30px_rgba(0,0,0,0.04)]",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(q,{className:"w-10 h-10 text-gray-300 fill-gray-100"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:r("favoritesEmpty")}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:r("favoritesEmptyHint")}),e.jsx(_,{to:"/products",className:"inline-block mt-8 px-8 py-3 bg-[#197853] text-white rounded-full font-medium hover:bg-[#0A4A30] transition-colors shadow-lg shadow-green-900/20",children:r("startShopping")})]}):e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 lg:gap-6",children:(f.length>0?f:i).map(t=>{const s={url:t.product.primaryImageUrl,name:t.product.name,priceOriginal:t.product.price,price:t.product.discountedPrice&&t.product.discountedPrice>0?t.product.discountedPrice:t.product.price,id:t.product.id,description:t.product.shortDescription||t.product.description,discountPercentage:t.product.discountPercentage,isHotDeal:t.product.isHotDeal};return e.jsx(G,{col:!0,info:s,productData:t.product,handleAddToCart:(o,a)=>D({},o,a),isAddingToCart:w===t.product.id,toggleFavorite:o=>S({},o),isFavorite:!0},t.id)})}),l>c&&e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-12",children:[e.jsx("button",{onClick:()=>p(t=>Math.max(1,t-1)),disabled:d===1,className:"w-10 h-10 flex items-center justify-center rounded-full bg-white border border-gray-200 text-gray-600 hover:bg-[#197853] hover:text-white hover:border-[#197853] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 shadow-sm",children:"<"}),e.jsxs("span",{className:"px-6 py-2 bg-white border border-gray-200 rounded-full text-gray-700 font-medium shadow-sm",children:[d," / ",Math.ceil(l/c)]}),e.jsx("button",{onClick:()=>p(t=>t+1),disabled:d>=Math.ceil(l/c),className:"w-10 h-10 flex items-center justify-center rounded-full bg-white border border-gray-200 text-gray-600 hover:bg-[#197853] hover:text-white hover:border-[#197853] disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 shadow-sm",children:">"})]})]}),e.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx(B,{products:N?.recentlyAdded,isLoading:F})})]})};export{te as default};
