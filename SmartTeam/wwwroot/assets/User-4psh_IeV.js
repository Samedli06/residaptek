import{l as H,ap as J,aq as T,r,j as e,y as f,u as K,ar as X,as as Z,at as ee,au as se,av as te,aw as ae,ax as O,ay as I,az as D,aA as re,aB as le,R as ne,aC as ie,aD as ce,aE as oe,aF as de,aG as xe}from"./index-BBhEgxr5.js";import{L as ue}from"./loader-circle-Bn7_-Q9n.js";import{M as me}from"./Modal-GV133dSV.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],S=H("loader",he),fe=({setOpen:c,edit:l})=>{if(!l)return null;const[E,{isLoading:j}]=J(),{data:o,error:w,isRolesLoading:q,refetch:N}=T(),[R,F]=r.useState([]);r.useEffect(()=>{F(o)},[o]);const[p,k]=r.useState(0),[d,v]=r.useState(!0),[h,x]=r.useState({}),[U,C]=r.useState(!1),g=r.useRef(null);r.useEffect(()=>{l&&(x({id:l.id,firstName:l.firstName||"",lastName:l.lastName||"",phoneNumber:l.phoneNumber||"",role:l.role||0,isActive:l.isActive??!0}),k(l.role||0),v(l.isActive??!0))},[l]),r.useEffect(()=>x(a=>({...a,role:p})),[p]),r.useEffect(()=>x(a=>({...a,isActive:d})),[d]),r.useEffect(()=>{const a=n=>{g.current&&!g.current.contains(n.target)&&c(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);const u=a=>{const{name:n,value:A}=a.target;x(M=>({...M,[n]:A}))},b=async a=>{a.preventDefault();try{await E(h).unwrap(),f.success("İstifadəçi uğurla yeniləndi!"),c()}catch{f.error("İstifadəçini yeniləmək uğursuz oldu")}};return e.jsxs("form",{ref:g,onSubmit:b,className:"flex flex-col gap-6 p-6 bg-[#1f1f1f] rounded-lg w-96",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-white text-sm mb-1",htmlFor:"firstName",children:["Ad ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"firstName",type:"text",required:!0,value:h.firstName||"",onChange:u,className:"w-full px-4 py-3 rounded-lg bg-[#2a2a2a] text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white placeholder:text-gray-400"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-white text-sm mb-1",htmlFor:"lastName",children:["Soyad ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"lastName",type:"text",required:!0,value:h.lastName||"",onChange:u,className:"w-full px-4 py-3 rounded-lg bg-[#2a2a2a] text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white placeholder:text-gray-400"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{className:"text-white text-sm mb-1",htmlFor:"phoneNumber",children:["Telefon nömrəsi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{name:"phoneNumber",type:"text",required:!0,value:h.phoneNumber||"",onChange:u,className:"w-full px-4 py-3 rounded-lg bg-[#2a2a2a] text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white placeholder:text-gray-400"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-white text-sm mb-1",htmlFor:"parent",children:"İstifadəçi rolu (tələb olunur)"}),e.jsx("select",{value:h.role,onChange:a=>x(n=>({...n,role:Number(a.target.value)})),id:"parent",className:"w-full px-4 py-3 rounded-lg bg-[#2a2a2a] text-white border border-gray-700 focus:outline-none focus:ring-2 focus:ring-white",children:R?.map((a,n)=>e.jsx("option",{value:Number(a.value),children:a.name},a.id||n))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"customCheckbox",checked:d,onChange:()=>v(!d),className:"w-5 h-5 rounded border-gray-600 bg-[#2a2a2a] text-blue-500 focus:outline-none cursor-pointer"}),e.jsx("label",{htmlFor:"customCheckbox",className:"text-white text-sm select-none",children:d?"Aktiv":"Deaktiv"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:j,className:"px-6 py-3 bg-white cursor-pointer text-black font-semibold rounded-lg hover:bg-gray-200 transition-all flex items-center justify-center",children:j?e.jsx(ue,{className:"w-6 h-6 animate-spin"}):"Yadda saxla"})})]})},Ne=()=>{const{t:c}=K(),{data:l,error:E,isLoading:j,refetch:o}=X(),{data:w,isRolesLoading:q}=T(),{data:N,error:R,isLoading:F,refetch:p}=Z(),[k,{isDeleteLoading:d}]=ee(),[v,{isRoleLoading:h}]=se(),[x,U]=r.useState(null),[C,g]=r.useState(null),[u,b]=r.useState(null),[a,n]=r.useState(null),[A,{isLoading:M}]=te(),[G,{isLoading:pe}]=ae(),y=[{key:"Admin",label:"Admin",icon:I},{key:"Normal user",label:"Ümumi",icon:D},{key:"Retail",label:"Topdan",icon:ie},{key:"Wholesale",label:"Diller",icon:ce},{key:"VIP",label:"Eksklüziv",icon:oe}];r.useEffect(()=>{const s=t=>{!t.target.closest(".role-dropdown-container")&&b(null)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]);const Q=async(s,t)=>{n(s);try{const i=await v({id:s,role:t}).unwrap(),z=y.find(m=>m.key===t)?.label||t;f.success(`Rolu uğurla dəyişdirildi: ${w[t].name}`),o(),p(),b(null)}catch(i){f.error(i?.data?.message||"Rol dəyişdirilə bilmədi")}finally{n(null)}},B=async s=>{try{const t=await A({id:s}).unwrap();o()}catch{}},P=async s=>{try{const t=await G({id:s}).unwrap();o()}catch{}},V=s=>{switch(s){case!0:return"text-green-400 bg-green-900/20";case!1:return"text-orange-400 bg-orange-900/20";default:return"text-gray-400 bg-gray-900/20"}},L=()=>{U(null),o(),p()},W=async s=>{try{const t=await k({id:s}).unwrap();f.success("İstifadəçi uğurla silindi"),L()}catch(t){f.error(t?.data||"İstifadəçini silmək uğursuz oldu")}},$=s=>{switch(s){case"Admin":return"text-purple-400 bg-purple-900/20";case"normalUsers":return"text-blue-400 bg-blue-900/20";case"Retail":return"text-green-400 bg-green-900/20";case"Wholesale":return"text-yellow-400 bg-yellow-900/20";case"VIP":return"text-pink-400 bg-pink-900/20";default:return"text-gray-400 bg-gray-700/20"}},_=s=>{const t=y.find(i=>i.key===s);return t?t.icon:D};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold !text-white",children:c("admin.users")}),e.jsx("p",{className:"text-gray-400 mt-1",children:c("admin.manageUsers")})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-blue-600 rounded-xl p-6 relative overflow-hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"!text-white text-sm font-medium",children:c("admin.totalUsers")}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:N?.totalUsers})]}),e.jsx("div",{className:"text-white/60",children:e.jsx(O,{className:"text-2xl"})})]})}),e.jsx("div",{className:"bg-purple-600 rounded-xl p-6 relative overflow-hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"!text-white text-sm font-medium",children:c("admin.admins")}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:N?.adminUsers})]}),e.jsx("div",{className:"text-white/60",children:e.jsx(I,{className:"text-2xl"})})]})}),e.jsx("div",{className:"bg-blue-500 rounded-xl p-6 relative overflow-hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"!text-white text-sm font-medium",children:"Ümumi istifadəçilər"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:N?.normalUsers})]}),e.jsx("div",{className:"text-white/60",children:e.jsx(D,{className:"text-2xl"})})]})})]}),e.jsx(me,{open:x==="edit",setOpen:L,children:C&&e.jsx(fe,{setOpen:L,edit:C})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:j?e.jsx(S,{}):l?.map(s=>e.jsxs("div",{className:"bg-gray-800 rounded-xl  hover:bg-gray-750 transition-colors duration-200",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("span",{onClick:()=>s.isActive?P(s.id):B(s.id),className:`px-2 py-1 cursor-pointer rounded-md text-xs font-medium ${V(s.isActive)}`,children:s.isActive?"Aktiv":"Deaktiv"})}),e.jsxs("div",{className:"absolute top-3 right-3 z-10 flex gap-2",children:[e.jsx("button",{onClick:()=>{U("edit"),g(s)},className:"p-2 bg-blue-600 cursor-pointer text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:e.jsx(re,{className:"text-sm"})}),e.jsx("button",{onClick:()=>{W(s.id)},className:"p-2 bg-red-600 cursor-pointer text-white rounded-lg hover:bg-red-700 transition-colors duration-200",children:d?e.jsx(S,{}):e.jsx(le,{className:"text-sm"})})]})]}),e.jsx("div",{className:"p-6 pb-4",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden mb-4 border-4 border-gray-600",children:e.jsx("img",{src:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=400&h=400&fit=crop&crop=face",className:"w-full h-full object-cover",alt:`${s.firstName} ${s.lastName}`})}),e.jsxs("h3",{className:"text-xl font-bold !text-white mb-1",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-gray-400 text-sm mb-3",children:s.email}),e.jsxs("div",{className:"relative role-dropdown-container",children:[e.jsx("div",{onClick:()=>b(u===s.id?null:s.id),className:`px-3 py-1 rounded-full cursor-pointer text-xs font-medium flex items-center gap-2 hover:opacity-80 transition-opacity ${$(s.roleName)} ${a===s.id?"opacity-50 pointer-events-none":""}`,children:a===s.id?e.jsx(S,{className:"w-3 h-3 animate-spin"}):e.jsxs(e.Fragment,{children:[ne.createElement(_(s.roleName),{className:"text-xs"}),e.jsx("span",{children:y.find(t=>t.key===s.roleName)?.label||s.roleName}),e.jsx(de,{className:`text-xs transition-transform ${u===s.id?"rotate-180":""}`})]})}),u===s.id&&e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 w-48 bg-gray-700 border border-gray-600 rounded-lg shadow-xl z-50 overflow-hidden",children:e.jsx("div",{className:"py-1",children:w?.map(t=>{const i=y.find(Y=>Y.key===t.name),z=i.icon,m=s.roleName===t.name;return e.jsxs("button",{onClick:()=>!m&&Q(s.id,t.value),className:`w-full px-4 py-2 text-sm text-left hover:bg-gray-600 transition-colors flex items-center gap-3 ${m?"bg-gray-600 cursor-default":"cursor-pointer"}`,disabled:m||a===s.id,children:[e.jsx("div",{className:`flex items-center justify-center w-5 h-5 rounded-full text-xs ${$(t.name).replace("bg-","bg-").replace("/20","/30")}`,children:e.jsx(z,{className:"text-xs"})}),e.jsx("span",{className:`flex-1 ${m?"text-white":"text-gray-200"}`,children:i.label}),m&&e.jsx(xe,{className:"text-green-400 text-xs"})]},t.value)})})})]})]})}),e.jsxs("div",{className:"px-6 pb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Qoşulma tarixi:"}),e.jsx("span",{className:"text-gray-300",children:new Date(s.createdAt).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Son daxilolma:"}),e.jsx("span",{className:"text-gray-300",children:s.lastLogin??"N/A"})]}),e.jsx("div",{className:"pt-3 border-t border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"İstifadəçi ID"}),e.jsx("span",{children:s.id})]})})]})]},s.id))}),e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"text-gray-500 mb-4",children:[e.jsx(O,{className:"text-4xl mx-auto mb-4 opacity-50"}),e.jsxs("p",{children:[l?.length," istifadəçi göstərilir"]})]})})]})};export{Ne as default};
