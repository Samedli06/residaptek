import{r as c,bp as F,bq as H,e as R,br as B,bs as U,j as e,$ as N,am as Q,M as _,N as q,y as x}from"./index-BBhEgxr5.js";import{F as G}from"./file-text-48VxCMpM.js";import{f as w}from"./format-CSQe5d3I.js";import{E as I}from"./eye-D9ml9ts3.js";import{T as X}from"./trash-2-B6-bQTRC.js";import{C as Z}from"./circle-x-DdM7zsRq.js";import{T as J}from"./truck-DEN7x2vj.js";import{C as K}from"./circle-check-big-BNNvvqDD.js";import{C as V}from"./clock-C4JeKsr-.js";const xe=()=>{const[a,g]=c.useState(1),[b,W]=c.useState(10),[m,v]=c.useState(""),[n,k]=c.useState(""),[C,{isFetching:h}]=F(),[S,{isLoading:Y}]=H(),y=R();c.useEffect(()=>{const s=setTimeout(()=>{k(m),g(1)},500);return()=>clearTimeout(s)},[m]);const d=n.trim().length>0,{data:z,isLoading:E,isError:ee,refetch:P}=B({page:a,pageSize:b},{skip:d}),{data:T,isLoading:L,isError:se}=U({customerName:n,page:a,pageSize:b},{skip:!d}),i=d?T:z;console.log(i);const O=d?L:E,o=i?.items||[],p=i?.totalCount||0,l=i?.totalPages||0,f=i?.hasNextPage||!1,j=i?.hasPreviousPage||!1,D=s=>{switch(s){case 0:return"bg-yellow-100 text-yellow-700 border-yellow-200";case 1:return"bg-blue-100 text-blue-700 border-blue-200";case 2:return"bg-green-100 text-green-700 border-green-200";case 3:return"bg-red-100 text-red-700 border-red-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},M=s=>{switch(s){case 0:return e.jsx(V,{size:16});case 1:return e.jsx(K,{size:16});case 2:return e.jsx(J,{size:16});case 3:return e.jsx(Z,{size:16});default:return null}},u=s=>{s>=1&&s<=l&&g(s)},$=async()=>{try{const s=await C({}).unwrap(),r=window.URL.createObjectURL(s),t=document.createElement("a");t.href=r,t.setAttribute("download",`Orders_Export_${w(new Date,"dd-MM-yyyy")}.pdf`),document.body.appendChild(t),t.click(),t.remove(),window.URL.revokeObjectURL(r),x.success("Hesabat endirilir...")}catch(s){x.error("PDF export xətası"),console.error("Bulk PDF Export Error:",s)}},A=async s=>{if(window.confirm("Bu sifarişi silmək istədiyinizə əminsiniz?"))try{await S(s).unwrap(),x.success("Sifariş silindi"),P()}catch{x.error("Sifarişi silmək mümkün olmadı")}};return O?e.jsx("div",{className:"flex items-center justify-center min-h-[400px] bg-[#111111]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"})}):e.jsxs("div",{className:"p-6 min-h-screen text-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold !text-white",children:"Sifarişlər"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Sistemdəki bütün sifarişlərin idarə edilməsi"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:$,disabled:h,className:`bg-[#1a1a1a] p-3 px-6 rounded-2xl shadow-sm border border-gray-800 flex items-center gap-3 hover:bg-white/5 transition-all text-white font-semibold ${h?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(G,{size:20,className:"text-red-500"}),h?"Hazırlanır...":"Eksport (PDF)"]}),e.jsxs("div",{className:"bg-[#1a1a1a] p-3 rounded-2xl shadow-sm border border-gray-800 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/10 rounded-xl flex items-center justify-center",children:e.jsx(N,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Ümumi sifariş"}),e.jsx("p",{className:"text-lg font-bold text-white",children:p})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(Q,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Müştəri adı ilə axtar...",value:m,onChange:s=>v(s.target.value),className:"w-full bg-[#1a1a1a] border border-gray-800 rounded-2xl pl-12 pr-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-green-500 transition-colors"})]}),n&&e.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:['"',n,'" üçün ',p," nəticə tapıldı"]})]}),e.jsxs("div",{className:"bg-[#1a1a1a] rounded-3xl shadow-sm border border-gray-800 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#151515] border-b border-gray-800 font-semibold text-gray-400 uppercase text-xs tracking-wider",children:[e.jsx("th",{className:"px-6 py-4",children:"Sifariş №"}),e.jsx("th",{className:"px-6 py-4",children:"Müştəri"}),e.jsx("th",{className:"px-6 py-4",children:"Aptek"}),e.jsx("th",{className:"px-6 py-4",children:"Məhsul sayı"}),e.jsx("th",{className:"px-6 py-4",children:"Məbləğ"}),e.jsx("th",{className:"px-6 py-4",children:"Status"}),e.jsx("th",{className:"px-6 py-4",children:"Tarix"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Fəaliyyət"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800 text-sm",children:o?.map(s=>e.jsxs("tr",{onClick:()=>y(`/admin/orders/${s.id}`),className:"hover:bg-[#202020] transition-colors cursor-pointer group",children:[e.jsxs("td",{className:"px-6 py-4 font-bold text-white",children:["#",s.orderNumber]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"font-semibold text-white",children:s.customerName})}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-300",children:s.pharmacyName||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"bg-[#252525] text-gray-300 px-2 py-1 rounded-lg text-xs font-medium",children:[s.itemsCount," məhsul"]})}),e.jsxs("td",{className:"px-6 py-4 font-bold text-white",children:[s.totalAmount?.toFixed(2)," AZN"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full border text-xs font-semibold ${D(s.status)}`,children:[M(s.status),s.statusText]})}),e.jsx("td",{className:"px-6 py-4 text-gray-400",children:s.createdAt?w(new Date(s.createdAt),"dd.MM.yyyy HH:mm"):"-"}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),y(`/admin/orders/${s.id}`)},className:"inline-flex items-center gap-1 text-white hover:bg-white/10 px-3 py-2 rounded-xl transition-all font-semibold shadow-sm",children:e.jsx(I,{size:18})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),A(s.id)},className:"inline-flex items-center gap-1 text-red-500 hover:bg-red-500/10 px-3 py-2 rounded-xl transition-all font-semibold shadow-sm",children:e.jsx(X,{size:18})})]})})]},s.id))})]})}),(!o||o.length===0)&&e.jsxs("div",{className:"py-20 text-center",children:[e.jsx(N,{className:"mx-auto text-gray-700 mb-4",size:48}),e.jsx("p",{className:"text-gray-500 font-medium",children:n?"Heç bir sifariş tapılmadı":"Hələ sifariş yoxdur"})]}),o&&o.length>0&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-800 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Səhifə ",a," / ",l," (Ümumi: ",p," sifariş)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>u(a-1),disabled:!j,className:`p-2 rounded-xl transition-colors ${j?"bg-white/10 text-white hover:bg-white/20":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:e.jsx(_,{size:20})}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(Math.min(5,l))].map((s,r)=>{let t;return l<=5||a<=3?t=r+1:a>=l-2?t=l-4+r:t=a-2+r,e.jsx("button",{onClick:()=>u(t),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${a===t?"bg-green-500 text-white":"bg-white/10 text-gray-300 hover:bg-white/20"}`,children:t},t)})}),e.jsx("button",{onClick:()=>u(a+1),disabled:!f,className:`p-2 rounded-xl transition-colors ${f?"bg-white/10 text-white hover:bg-white/20":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:e.jsx(q,{size:20})})]})]})]})]})};export{xe as default};
